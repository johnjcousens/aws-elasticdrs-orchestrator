# Configuration-Management-Design

**Confluence Page:** https://healthedge.atlassian.net/wiki/spaces/CP1/pages/4866083989/Configuration-Management-Design

**Created by:** Chris Falk on June 16, 2025  
**Last modified by:** Chris Falk on June 16, 2025 at 02:03 AM

---

| **Overview** |
| --- |
| Configuration management is a foundational capability in order to audit AWS resources and investigate operational issues.  Configuration management in AWS involves tracking the configuration state and configuration history of AWS resources across AWS accounts and regions.  This includes the unique properties of each AWS resource and how those properties have changed over time.  Additionally, configuration tracking in AWS includes tracking the relationships between AWS resources, such as the relationship between an EC2 instance and an elastic ip address.  Configuration tracking in AWS is automated with the use of [AWS Config.](https://docs.aws.amazon.com/config/)  Integration with an existing ServiceNow CMDB system can be achieved using the ServiceNow integration with [ServiceNow using the AWS Service Management connector for ServiceNow](https://docs.aws.amazon.com/servicecatalog/latest/adminguide/integrations-servicenow.html). |

| **AWS Recommended Cloud Approach** |
| --- |
| The AWS recommended approach uses AWS Config for automatically tracking the configuration of AWS resources as configuration items. Customers may also have their own tools for tracking software configuration and changes on their existing servers using a separate product or service. The baseline operational readiness state recommends enabling AWS Config recording in all accounts and regions that the customer will use.  Additionally, it is recommended to aggregate AWS config information into one account and region when using multiple accounts and multiple regions.   Aggregating information into a single, special purpose account such as a logging account enables you to more effectively track and manage changes across your accounts and regions rather than tracking and managing changes separately.  An AWS Config recorder should be deployed to each account and region across the AWS organization using an AWS Service Managed StackSet in CloudFormation.  This enables you to manage the setup of AWS Config in one place across all your accounts and regions.  It is recommended that you enable recording of all AWS resources.  However, selective resource type configuration recording may be considered if cost is a limiting factor.  In these situations, it is still recommended that you enable all resource configuration recording in your production / mission critical environments.  AWS Config supports the [delivery of configuration items in JSON formatted files to an Amazon S3 bucket of your choice](https://docs.aws.amazon.com/config/latest/developerguide/how-does-config-work.html#delivery-channel).  It is recommended that you create a centralized S3 bucket for AWS config to deliver configuration items so that you can maintain a history of your configuration changes for audit purposes.  This S3 bucket can be located in a logging account and preferred region.  AWS Config provides an Aggregator feature to consolidate configuration information across accounts and regions.  It is recommended that you create an AWS Config aggregator at the organization level so that AWS Config aggregates data across all your accounts and regions in your AWS Organization.  When new accounts are added to the organization, the configuration information will automatically be aggregated.  It is recommended that you create the AWS Config aggregator in a logging account and preferred region.  In order to do this, you must [enable the account as a delegated administrator for AWS config](https://docs.aws.amazon.com/config/latest/developerguide/set-up-aggregator-cli.html#register-a-delegated-administrator-cli).  AWS Config provides AWS Config rules so you can validate and report on the desired configuration of your AWS resources as well as perform manual or automated remediation.  It is recommended that customers evaluate [AWS provided sample conformance packs](https://docs.aws.amazon.com/config/latest/developerguide/conformancepack-sample-templates.html) and select the appropriate conformance pack(s) that will meet their operational, compliance, and security objectives.  For example, customers may start with the [Operational Best Practices for EC2 conformance pack](https://docs.aws.amazon.com/config/latest/developerguide/operational-best-practices-for-EC2.html).  The selected conformance pack should be deployed to every account and region in the customers AWS Organization used by the customer using a service managed StackSet.  Customers can continue to use their existing configuration management tools for software level changes while using AWS config for service level changes.  Customers can also use the [AWS Systems Manager Inventory feature and integration with AWS config](https://docs.aws.amazon.com/config/latest/developerguide/recording-managed-instance-inventory.html) to track software level changes on EC2 and on-premises AWS Systems Manager managed instances.  Customers can also integrate their existing CMDB with AWS Config if the vendor they are using provides a supported supported integration.  If customers are using ServiceNow, they can use the [the AWS Service Management connector for ServiceNow](https://docs.aws.amazon.com/servicecatalog/latest/adminguide/integrations-servicenow.html).  Customers are encouraged to not implement processes that would require manual configuration recording in order to provision or change resources in AWS.  This can significantly reduce the speed and agility that can be achieved by using AWS. |

| **Design Decisions** |
| --- |
| The following design decisions need to be made in order to complete the Configuration Management Design. AWS Config RecorderAWS Config Role What is the name of the AWS Config service role that will be used to record resources?  Is it the same role name in each account? AWS Config Bucket What is the name of the AWS config bucket where AWS config will send configuration snapshots?  It is recommended that you use a single bucket to store configuration snapshots for all your accounts and regions.  When AWS Config sends the snapshots, it will place them in a folder structure that starts with the account number and includes a prefix for each region. AWS Config Bucket Retention Policy How long do you want to keep configuration snapshots before deleting or transitioning them to lower cost storage?  It is recommended that you evaluate the length of time that you will need the configuration snapshots present in the S3 bucket for use before they will no longer be used to determine this value. AWS Config Delivery Frequency What is the frequency that AWS Config should deliver configuration snapshots?  The default configuration is every 6 hours.  The delivery frequency also determines the frequency with which AWS config rules can be evaluated for compliance / remediation.  The minimum frequency is 1 hour and the maximum frequency is 24 hours.  It is recommended that you leave the default setting unless you have other rule evaluation requirements. AWS Config Recorded Resources What AWS resources will be configured for recording?  It is recommended that you record all supported AWS resources.  However, you may choose to record a subset of AWS resource types to reduce costs. AWS Config AggregatorAWS Config Aggregator Delegated Administrator Account AWS Organizations allows you to specify a delegated administrator for AWS Config management at the organizational level.  It is recommended that you use a separate account for managing AWS Config data aggregation from the AWS Organizations account.  You can register the AWS delegated administrator account by [following this blog post](https://aws.amazon.com/blogs/mt/org-aggregator-delegated-admin/). AWS Config Aggregator Region What is the AWS region where AWS Config will aggregate records?  This region will receive all the AWS config records for all AWS Organization accounts. AWS Config Aggregator Targets You must select the AWS accounts from which you will aggregate AWS Config data.  The aggregated data is in addition to the data being available locally in each account.  It is important to note that AWS Config must be enabled and recording resources in each region you select. Accounts What AWS accounts will AWS Config aggregate data from?  It is recommended that you aggregate data for the entire AWS Organization.  This will ensure that data is aggregated for new accounts as they are added.  In order to have a complete compliance picture it is important to aggregate data from all accounts.  If you choose not to aggregate all accounts then you should aggregate data for your production accounts at the very least. Regions What AWS regions will AWS config aggregate data from?  It is recommended that you aggregate data from all regions where you will have AWS resources deployed. AWS Config Managed Rules What AWS Config rules do you want to deploy to your accounts?  It is recommended that you preselect and deploy a common set of AWS config rules to all your AWS accounts.  You will not be able to determine rule compliance across your accounts from your AWS Config aggregator account unless the same rule is deployed to each account and region.  Review the [complete list of available managed rules in the documentation.](https://docs.aws.amazon.com/config/latest/developerguide/managed-rules-by-aws-config.html) AWS Config Conformance Packs What AWS Config conformance packs will you deploy to your accounts?  It is recommended that you [review the available sample AWS Config Conformance packs](https://docs.aws.amazon.com/config/latest/developerguide/conformancepack-sample-templates.html) and deploy the same conformance pack to all regions and accounts.  You may choose to create your own conformance packs from the set of AWS Config Managed rules that you have selected. |

| **AWS Operational Readiness State Recommendations** |
| --- |
| Actions The following actions are recommended for operational readiness:   * Source types identified for recording in Non Production vs. Production   for accounts and regions.  It is recommended that all resources are initially   recorded in all accounts. * AWS Config Recorder turned on and configured in each account with AWS   resource types identified for configuration management * AWS Config aggregator turned on in management / delegated admin account   and configured for organization. * Individual AWS Config Recorders in each account configured to log to account   bucket as well as log archive account / bucket. * Separate encryption key for AWS Config created in security account and   configured with S3 log archive AWS Config bucket. * AWS Config Retention period defined and implemented across all regions   and accounts. * Evaluated AWS Managed config Rules and selected specific rules for general   deployment across organization. * AWS Managed Config Rules that were selected deployed in required accounts   and regions with appropriate targets. * Test when ready. * AWS Organization CloudTrail created and implemented in all regions and   accounts.    + Cloudwatch logging enabled   + Logging to bucket in Log Archive account.   + Separate KMS key created in security account for CloudTrail.   + S3 bucket configured with CloudTrail KMS key.   + Setup already across accounts and regions. * Configure Service Control Policy that denies turning off AWS Config and   AWS CloudTrail. * Configure S3 bucket lifecycle rule for AWS Config logs to align to customers   retention goals. * Verify AWS Config configuration recording in each region and account for   selected resources. * Verify AWS Config rule evaluation in each region and account. * Verify config delivery to S3 bucket. * Verify aggregation of configuration items in delegated Administrator account. * Verify that CloudTrail is recording all resources. * Deliver AWS Config immersion day session to administrators. * Develop a runbook or process around AWS Config    + Review the AWS Config Dashboard periodically (preferably daily).   + Create tickets for any non-compliant rules.           - Remediate or document any non-compliant rules and adjust rules as necessary. |

| **Recommendations for Future Enhancements** |
| --- |
| **Evolve process around AWS Config**   * Develop new and custom AWS Config rules to monitor and enforce the standards you have established.       + A config rule to ensure all custom or required tags are applied to instances * Add approved-amis-by-id AWS Config rule to ensure only trusted machine images are launched. This will require integration with the patch management process * Automate responses to AWS Config rules via SNS or other alerting and monitoring solution. * Integrate with CMDB   **Monitor and alert on** **AWS CloudTrail events**   * AWS CloudTrail events are searchable within the AWS console for only the prior seven (7) days. * Integrate AWS CloudTrail with your log management solution. * Send AWS CloudTrail events to Amazon CloudWatch and develop filters on which to alert based on prohibited users, actions or events.   **Practice Infrastructure as Code**   * Work toward making all infrastructure changes in production, staging and simulation environments exclusively through CloudFormation or other infrastructure management tools. * Configure CloudTrail filter to alert on any changes not performed via automation.   **Systems Configuration Management**  Ensure Systems Configuration Management is ubiquitous and scalable. If a combination of AWS CloudFormation and user-data/auto scaling/launch configuration is sufficient, that is great. However, this is rarely the case. As cloud adoption progresses, and more applications are deployed and running on AWS, the complexity and interdependence is often too much to handle in this fashion. This is where a hierarchical configuration management tools can help.    These tools can help manage configuration across:   * Account * Environment * Stack * Application * Version * Other organizational grouping     By tagging AWS resources you can categorize and [query for resources based on their hierarchical properties using advanced queries](https://docs.aws.amazon.com/config/latest/developerguide/querying-AWS-resources.html). |

**Attachments:**

[image2019-6-23\_15-27-11.png](../../attachments/image2019-6-23_15-27-11.png)

[image2019-6-23\_15-33-52.png](../../attachments/image2019-6-23_15-33-52.png)

[worddav828d56f2b4b342b334ff319f80e0b56d.png](../../attachments/worddav828d56f2b4b342b334ff319f80e0b56d.png)

[worddave2e2ee13bda9daff7ce4c0b5cabbba57.png](../../attachments/worddave2e2ee13bda9daff7ce4c0b5cabbba57.png)