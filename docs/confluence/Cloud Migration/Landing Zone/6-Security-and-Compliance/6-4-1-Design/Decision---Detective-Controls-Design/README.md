# Decision---Detective-Controls-Design

**Confluence Page:** https://healthedge.atlassian.net/wiki/spaces/CP1/pages/4867000289/Decision---Detective-Controls-Design

**Created by:** Chris Falk on June 16, 2025  
**Last modified by:** Chris Falk on September 25, 2025 at 05:49 PM

---

### Document Lifecycle Status

**Purpose**
-----------

This document outlines details about detective and preventative controls which will be enabled in AWS accounts.

**Security Controls**
---------------------

The following sections provide details of security controls that can be put in place through various AWS services to assist in the monitoring and prevention within your AWS Organization accounts.

**AWS Security Hub**

AWS Security Hub is a cloud security posture management service that performs security best practice checks, aggregates alerts, and enabled automated remediation.

Use the below tables to document the Controls that are to be enabled via AWS Security Hub via the Landing Zone Accelerator

NOTE: AMS Accelerate deploys a set of AWS Config detective controls. To avoid duplicate controls, ensure those are excluded in this implementation design.

**Default Initial set of Preventative and Detective Controls**

| Disallow Changes to Encryption Configuration for AWS Control Tower Created S3 Buckets in Log Archive | Control Tower | Preventative | Mandatory | Enable | Security |
| --- | --- | --- | --- | --- | --- |
| Disallow Changes to Logging Configuration for AWS Control Tower Created S3 Buckets in Log Archive | Control Tower | Preventative | Mandatory | Enable | Security |
| Disallow Changes to Bucket Policy for AWS Control Tower Created S3 Buckets in Log Archive | Control Tower | Preventative | Mandatory | Enable | Security |
| Disallow Changes to Lifecycle Configuration for AWS Control Tower Created S3 Buckets in Log Archive | Control Tower | Preventative | Mandatory | Enable | Security |
| Disallow Changes to CloudWatch Logs Log Groups | Control Tower | Preventative | Mandatory | Enable | All |
| Disallow Deletion of AWS Config Aggregation Authorization | Control Tower | Preventative | Mandatory | Enable | All |
| Disallow Deletion of Log Archive | Control Tower | Preventative | Mandatory | Enable | Security |
| Disallow Public Read Access to Log Archive | Control Tower | Detective | Mandatory | Enable | Security |
| Disallow Public Write Access to Log Archive | Control Tower | Detective | Mandatory | Enable | Security |
| Disallow Configuration Changes to CloudTrail | Control Tower | Preventative | Mandatory | Enable | All |
| Integrate CloudTrail Events with CloudWatch Logs | Control Tower | Preventative | Mandatory | Enable | All |
| Enable CloudTrail in All Available Regions | Control Tower | Preventative | Mandatory | Enable | All |
| Enable Integrity Validation for CloudTrail Log File | Control Tower | Preventative | Mandatory | Enable | All |
| Disallow Changes to CloudWatch Set Up by AWS Control Tower | Control Tower | Preventative | Mandatory | Enable | All |
| Disallow Changes to AWS Config Aggregation Set Up by AWS Control Tower | Control Tower | Preventative | Mandatory | Enable | All |
| Disallow Configuration Changes to AWS Config | Control Tower | Preventative | Mandatory | Enable | All |
| Enable AWS Config in All Available Regions | Control Tower | Preventative | Mandatory | Enable | All |
| Disallow Changes to AWS Config Rules Set Up by AWS Control Tower | Control Tower | Preventative | Mandatory | Enable | All |
| Disallow Changes to IAM Roles Set Up by AWS Control Tower and AWS Cloudformation | Control Tower | Preventative | Mandatory | Enable | All |
| Disallow Changes to Lambda Functions Set Up by AWS Control Tower | Control Tower | Preventative | Mandatory | Enable | All |
| Disallow Changes to Amazon SNS Set Up by AWS Control Tower | Control Tower | Preventative | Mandatory | Enable | All |
| Detect Changes to Amazon SNS Subscriptions Set Up by AWS Control Tower | Control Tower | Preventative | Mandatory | Enable | All |
| Detect whether shared accounts under the Security organizational unit have AWS CloudTrail or CloudTrail Lake enabled | Control Tower | Detective | Mandatory | Enable | Security |
| Disallow Creation of Access Keys for the Root User | Control Tower | Preventative | Strongly Recommended | Enable | All |
| Disallow Actions as a Root User | Control Tower | Preventative | Strongly Recommended | Enable | All |
| Detect whether Encryption is enabled for Amazon EBS Volumes Attached to Amazon EC2 Instances | Control Tower | Detective | Strongly Recommended | Enable | All |
| Detect whether Unrestricted Incoming TCP traffic is allowed | Control Tower | Detective | Strongly Recommended | Enable | All |
| Detect whether unrestricted Internet Connection Through SSH is allowed | Control Tower | Detective | Strongly Recommended | Enable | All |
| Detect whether MFA for the Root User is Enabled | Control Tower | Detective | Strongly Recommended | Enable | All |
| Detect whether Public Read Access to Amazon S3 Buckets is enabled | Control Tower | Detective | Strongly Recommended | Enable | All |
| Detect whether Public Write Access to Amazon S3 Buckets is enabled | Control Tower | Detective | Strongly Recommended | Enable | All |
| Detect whether Amazon EBS Volumes That Are Unattached to An Amazon EC2 Instance | Control Tower | Detective | Strongly Recommended | Enable | All |
| Detect whether Public Access to Amazon RDS Database Instances is enabled | Control Tower | Detective | Strongly Recommended | Enable | All |
| Detect whether Public Access to Amazon RDS Database Snapshots is enabled | Control Tower | Detective | Strongly Recommended | Enable | All |
| Detect whether Storage Encryption is enabled for Amazon RDS Database instances | Control Tower | Detective | Strongly Recommended | Enable | All |
| Detect whether an account has AWS CloudTrail or CloudTrail Lake enabled | Control Tower | Detective | Strongly Recommended | Enable | All |
| Disallow Changes to Encryption Configuration for Amazon S3 Buckets | Control Tower | Preventative | Elective | Enable | n/a |
| Disallow Changes to Logging Configuration for Amazon S3 Buckets | Control Tower | Preventative | Elective | Enable | n/a |
| Detect whether MFA is enabled for AWS IAM Users | Control Tower | Detective | Elective | Enable | All |
| Restrict regions that can be used | Control Tower | Preventative | Custom | Enable | All |
| Prevent changes to S3 public access block | Custom | Preventative | Custom | Enable | All |

#### **AWS Foundational Security Best Practices**

| Title | Description | Severity | Implementation | Enable? |
| --- | --- | --- | --- | --- |
| [\[ACM.1\] ACM certificates should be renewed after a specified time period](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-acm-1) | This control checks whether ACM certificates in your account are marked for expiration within 30 days. It checks both imported certificates and certificates provided by AWS Certificate Manager. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 1 1 incomplete |
| [\[APIGateway.1\] API Gateway REST and WebSocket API execution logging should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-apigateway-1) | This control checks whether all stages of an Amazon API Gateway REST or WebSocket API have logging enabled. The control fails if logging is not enabled for all methods of a stage or if `loggingLevel` is neither `ERROR` nor `INFO`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 2 2 incomplete |
| [\[APIGateway.2\] API Gateway REST API stages should be configured to use SSL certificates for backend authentication](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-apigateway-2) | This control checks whether Amazon API Gateway REST API stages have SSL certificates configured. Backend systems use these certificates to authenticate that incoming requests are from API Gateway. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 3 3 incomplete |
| [\[APIGateway.3\] API Gateway REST API stages should have AWS X-Ray tracing enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-apigateway-3) | This control checks whether AWS X-Ray active tracing is enabled for your Amazon API Gateway REST API stages. | LOW | AWS Security Hub Standard via security-config.yaml | 4 4 incomplete |
| [\[APIGateway.4\] API Gateway should be associated with a WAF Web ACL](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-apigateway-4) | This control checks whether an API Gateway stage uses an AWS WAF web access control list (ACL). This control fails if an AWS WAF web ACL is not attached to a REST API Gateway stage. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 5 5 incomplete |
| [\[APIGateway.5\] API Gateway REST API cache data should be encrypted at rest](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-apigateway-5) | This control checks whether all methods in API Gateway REST API stages that have cache enabled are encrypted. The control fails if any method in an API Gateway REST API stage is configured to cache and the cache is not encrypted. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 6 6 incomplete |
| [\[AutoScaling.1\] Auto scaling groups associated with a load balancer should use load balancer health checks](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-autoscaling-1) | This control checks whether your Auto Scaling groups that are associated with a load balancer are using Elastic Load Balancing health checks. | LOW | AWS Security Hub Standard via security-config.yaml | 7 7 incomplete |
| [\[AutoScaling.2\] Amazon EC2 Auto Scaling group should cover multiple Availability Zones](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-autoscaling-2) | This control checks whether an Auto Scaling group spans multiple Availability Zones. The control fails if an Auto Scaling group does not span multiple availability zones. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 8 8 incomplete |
| [\[Autoscaling.5\] Amazon EC2 instances launched using Auto Scaling group launch configurations should not have Public IP addresses](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-autoscaling-5) | This control checks whether an Auto Scaling group's associated launch configuration assigns a [public IP address](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#public-ip-addresses) to the groupâ€™s instances. The control fails if the associated launch configuration assigns a public IP address. | HIGH | AWS Security Hub Standard via security-config.yaml | 9 9 incomplete |
| [\[CloudFront.1\] CloudFront distributions should have a default root object configured](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudfront-1) | This control checks whether an Amazon CloudFront distribution is configured to return a specific object that is the default root object. The control fails if the CloudFront distribution does not have a default root object configured. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 10 10 incomplete |
| [\[CloudFront.2\] CloudFront distributions should have origin access identity enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudfront-2) | This control checks whether an Amazon CloudFront distribution with Amazon S3 Origin type has Origin Access Identity (OAI) configured. The control fails if OAI is not configured. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 11 11 incomplete |
| [\[CloudFront.3\] CloudFront distributions should require encryption in transit](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudfront-3) | This control checks whether an Amazon CloudFront distribution requires viewers to use HTTPS directly or whether it uses redirection. The control fails if `ViewerProtocolPolicy` is set to `allow-all` for `defaultCacheBehavior` or for `cacheBehaviors`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 12 12 incomplete |
| [\[CloudFront.4\] CloudFront distributions should have origin failover configured](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudfront-4) | This control checks whether an Amazon CloudFront distribution is configured with an origin group that has two or more origins. | LOW | AWS Security Hub Standard via security-config.yaml | 13 13 incomplete |
| [\[CloudFront.5\] CloudFront distributions should have logging enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudfront-5) | This control checks whether server access logging is enabled on CloudFront distributions. The control fails if access logging is not enabled for a distribution. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 14 14 incomplete |
| [\[CloudFront.6\] CloudFront distributions should have WAF enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudfront-6) | This control checks whether CloudFront distributions are associated with either AWS WAF or AWS WAFv2 web ACLs. The control fails if the distribution is not associated with a web ACL. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 15 15 incomplete |
| [\[CloudFront.7\] CloudFront distributions should use custom SSL/TLS certificates](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudfront-7) | This control checks whether CloudFront distributions are using the default SSL/TLS certificate CloudFront provides. This control passes if the CloudFront distribution uses a custom SSL/TLS certificate. This control fails if the CloudFront distribution uses the default SSL/TLS certificate. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 16 16 incomplete |
| [\[CloudFront.8\] CloudFront distributions should use SNI to serve HTTPS requests](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudfront-8) | This control checks if Amazon CloudFront distributions are using a custom SSL/TLS certificate and are configured to use SNI to serve HTTPS requests. This control fails if a custom SSL/TLS certificate is associated but the SSL/TLS support method is a dedicated IP address. | LOW | AWS Security Hub Standard via security-config.yaml | 17 17 incomplete |
| [\[CloudFront.9\] CloudFront distributions should encrypt traffic to custom origins](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudfront-9) | This control checks if Amazon CloudFront distributions are encrypting traffic to custom origins. This control fails for a CloudFront distribution whose origin protocol policy allows 'http-only'. This control also fails if the distribution's origin protocol policy is 'match-viewer' while the viewer protocol policy is 'allow-all'. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 18 18 incomplete |
| [\[CloudTrail.1\] CloudTrail should be enabled and configured with at least one multi-region trail](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudtrail-1) | This control checks that there is at least one multi-Region CloudTrail trail. It also checks that the `ExcludeManagementEventSources` parameter is empty for at least one of those trails. | HIGH | AWS Security Hub Standard via security-config.yaml | 19 19 incomplete |
| [\[CloudTrail.2\] CloudTrail should have encryption at-rest enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudtrail-2) | This control checks whether CloudTrail is configured to use the server-side encryption (SSE) AWS KMS key encryption. The check passes if the `KmsKeyId` is defined. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 20 20 incomplete |
| [\[CloudTrail.4\] CloudTrail log file validation should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudtrail-4) | This control checks whether log file integrity validation is enabled on a CloudTrail trail. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 21 21 incomplete |
| [\[CloudTrail.5\] CloudTrail trails should be integrated with Amazon CloudWatch Logs](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-cloudtrail-5) | This control checks whether CloudTrail trails are configured to send logs to CloudWatch Logs. The control fails if the `CloudWatchLogsLogGroupArn` property of the trail is empty. | LOW | AWS Security Hub Standard via security-config.yaml | 22 22 incomplete |
| [\[CodeBuild.1\] CodeBuild GitHub or Bitbucket source repository URLs should use OAuth](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-codebuild-1) | This control checks whether the GitHub or Bitbucket source repository URL contains either personal access tokens or a user name and password. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 23 23 incomplete |
| [\[CodeBuild.2\] CodeBuild project environment variables should not contain clear text credentials](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-codebuild-2) | This control checks whether the project contains the environment variables `AWS_ACCESS_KEY_ID` and `AWS_SECRET_ACCESS_KEY`. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 24 24 incomplete |
| [\[CodeBuild.4\] CodeBuild project environments should have a logging configuration](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-codebuild-4) | This control checks whether a CodeBuild project environment has at least one log option, either to S3 or CloudWatch logs enabled. This control fails if a CodeBuild project environment does not have at least one log option enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 25 25 incomplete |
| [\[CodeBuild.5\] CodeBuild project environments should not have privileged mode enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-codebuild-5) | This control checks if an AWS CodeBuild project environment has privileged mode enabled. This control fails when an AWS CodeBuild project environment has privileged mode enabled. | HIGH | AWS Security Hub Standard via security-config.yaml | 26 26 incomplete |
| [\[Config.1\] AWS Config should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-config-1) | This control checks whether AWS Config is enabled in the account for the local Region and is recording all resources. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 27 27 incomplete |
| [\[DMS.1\] Database Migration Service replication instances should not be public](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-dms-1) | This control checks whether AWS DMS replication instances are public. To do this, it examines the value of the `PubliclyAccessible` field. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 28 28 incomplete |
| [\[DynamoDB.1\] DynamoDB tables should automatically scale capacity with demand](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-dynamodb-1) | This control checks whether an Amazon DynamoDB table can scale its read and write capacity as needed. This control passes if the table uses either on-demand capacity mode or provisioned mode with auto scaling configured. Scaling capacity with demand avoids throttling exceptions, which helps to maintain availability of your applications. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 29 29 incomplete |
| [\[DynamoDB.2\] DynamoDB tables should have point-in-time recovery enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-dynamodb-2) | This control checks whether point-in-time recovery (PITR) is enabled for an Amazon DynamoDB table. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 30 30 incomplete |
| [\[DynamoDB.3\] DynamoDB Accelerator (DAX) clusters should be encrypted at rest](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-dynamodb-3) | This control checks whether a DAX cluster is encrypted at rest. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 31 31 incomplete |
| [\[EC2.1\] EBS snapshots should not be publicly restorable](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-1) | This control checks whether Amazon Elastic Block Store snapshots are not public. The control fails if Amazon EBS snapshots are restorable by anyone. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 32 32 incomplete |
| [\[EC2.2\] The VPC default security group should not allow inbound and outbound traffic](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-2) | This control checks that the default security group of a VPC does not allow inbound or outbound traffic. | HIGH | AWS Security Hub Standard via security-config.yaml | 33 33 incomplete |
| [\[EC2.3\] Attached EBS volumes should be encrypted at-rest](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-3) | This control checks whether the EBS volumes that are in an attached state are encrypted. To pass this check, EBS volumes must be in use and encrypted. If the EBS volume is not attached, then it is not subject to this check. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 34 34 incomplete |
| [\[EC2.4\] Stopped EC2 instances should be removed after a specified time period](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-4) | This control checks whether any EC2 instances have been stopped for more than the allowed number of days. An EC2 instance fails this check if it is stopped for longer than the maximum allowed time period, which by default is 30 days. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 35 35 incomplete |
| [\[EC2.6\] VPC flow logging should be enabled in all VPCs](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-6) | This control checks whether Amazon VPC Flow Logs are found and enabled for VPCs. The traffic type is set to `Reject`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 36 36 incomplete |
| [\[EC2.7\] EBS default encryption should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-7) | This control checks whether account-level encryption is enabled by default for Amazon Elastic Block Store(Amazon EBS). The control fails if the account level encryption is not enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 37 37 incomplete |
| [\[EC2.8\] EC2 instances should use Instance Metadata Service Version 2 (IMDSv2)](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-8) | This control checks whether your EC2 instance metadata version is configured with Instance Metadata Service Version 2 (IMDSv2). The control passes if `HttpTokens` is set to required for IMDSv2. The control fails if `HttpTokens` is set to `optional`. | HIGH | AWS Security Hub Standard via security-config.yaml | 38 38 incomplete |
| [\[EC2.9\] EC2 instances should not have a public IPv4 address](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-9) | This control checks whether EC2 instances have a public IP address. The control fails if the `publicIp` field is present in the EC2 instance configuration item. This control applies to IPv4 addresses only. | HIGH | AWS Security Hub Standard via security-config.yaml | 39 39 incomplete |
| [\[EC2.10\] Amazon EC2 should be configured to use VPC endpoints that are created for the Amazon EC2 service](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-10) | This control checks whether a service endpoint for Amazon EC2 is created for each VPC. The control fails if a VPC does not have a VPC endpoint created for the Amazon EC2 service. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 40 40 incomplete |
| [\[EC2.15\] EC2 subnets should not automatically assign public IP addresses](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-15) | This control checks whether the assignment of public IPs in Amazon Virtual Private Cloud (Amazon VPC) subnets have `MapPublicIpOnLaunch` set to `FALSE`. The control passes if the flag is set to `FALSE`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 41 41 incomplete |
| [\[EC2.16\] Unused Network Access Control Lists should be removed](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-16) | This control checks whether there are any unused network access control lists (ACLs). | LOW | AWS Security Hub Standard via security-config.yaml | 42 42 incomplete |
| [\[EC2.17\] EC2 instances should not use multiple ENIs](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-17) | This control checks whether an EC2 instance uses multiple Elastic Network Interfaces (ENIs) or Elastic Fabric Adapters (EFAs). This control passes if a single network adapter is used. The control includes an optional parameter list to identify the allowed ENIs. | LOW | AWS Security Hub Standard via security-config.yaml | 43 43 incomplete |
| [\[EC2.18\] Security groups should only allow unrestricted incoming traffic for authorized ports](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-18) | This control checks whether the security groups that are in use allow unrestricted incoming traffic. Optionally the rule checks whether the port numbers are listed in the `authorizedTcpPorts` parameter.   * If the security group rule port number allows unrestricted incoming traffic,   but the port number is specified in `authorizedTcpPorts`, then   the control passes. The default value for `authorizedTcpPorts` is `80, 443`. * If the security group rule port number allows unrestricted incoming traffic,   but the port number is not specified in `authorizedTcpPorts` input   parameter, then the control fails. * If the parameter is not used, then the control fails for any security   group that has an unrestricted inbound rule. | HIGH | AWS Security Hub Standard via security-config.yaml | 44 44 incomplete |
| [\[EC2.19\] Security groups should not allow unrestricted access to ports with high risk](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-19) | This control checks whether unrestricted incoming traffic for the security groups is accessible to the specified ports that have the highest risk. This control passes when none of the rules in a security group allow ingress traffic from 0.0.0.0/0 for those ports. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 45 45 incomplete |
| [\[EC2.20\] Both VPN tunnels for an AWS Site-to-Site VPN connection should be up](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-20) | A VPN tunnel is an encrypted link where data can pass from the customer network to or from AWS within an AWS Site-to-Site VPN connection. Each VPN connection includes two VPN tunnels which you can simultaneously use for high availability. Ensuring that both VPN tunnels are up for a VPN connection is important for confirming a secure and highly available connection between an AWS VPC and your remote network. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 46 46 incomplete |
| [\[EC2.21\] Network ACLs should not allow ingress from 0.0.0.0/0 to port 22 or port 3389](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-21) | This control checks whether a network access control list (NACL) allows unrestricted access to the default ports for SSH/RDP ingress traffic. The rule fails if a NACL inbound entry allows a source CIDR block of '0.0.0.0/0' or '::/0' for ports 22 or 3389. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 47 47 incomplete |
| [\[EC2.22\] Unused EC2 security groups should be removed](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ec2-22) | This AWS control checks that security groups are attached to Amazon Elastic Compute Cloud (Amazon EC2) instances or to an elastic network interface. The control will fail if the security group is not associated with an Amazon EC2 instance or an elastic network interface. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 48 48 incomplete |
| [\[ECR.3\] ECR repositories should have at least one lifecycle policy configured](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ecr-3) | This control checks whether an Amazon ECR repository has at least one lifecycle policy configured. This control fails if an ECR repository does not have any lifecycle policies configured. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 49 49 incomplete |
| [\[ECS.1\] Amazon ECS task definitions should have secure networking modes and user definitions.](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ecs-1) | This control checks whether an active Amazon ECS task definition that has host networking mode also has `privileged` or `user` container definitions. The control fails for task definitions that have host network mode and container definitions where `privileged=false` or is empty and `user=root` or is empty. | HIGH | AWS Security Hub Standard via security-config.yaml | 50 50 incomplete |
| [\[ECS.2\] ECS services should not have public IP addresses assigned to them automatically](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ecs-2) | This control checks whether Amazon ECS services are configured to automatically assign public IP addresses. This control fails if `AssignPublicIP` is `ENABLED`. This control passes if `AssignPublicIP` is `DISABLED`. | HIGH | AWS Security Hub Standard via security-config.yaml | 51 51 incomplete |
| [\[EFS.1\] Elastic File System should be configured to encrypt file data at-rest using AWS KMS](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-efs-1) | This control checks whether Amazon Elastic File System is configured to encrypt the file data using AWS KMS. The check fails in the following cases.   * `Encrypted` is set to `false` in the [DescribeFileSystems](https://docs.aws.amazon.com/efs/latest/ug/API_DescribeFileSystems.html) response. * The `KmsKeyId` key in the [DescribeFileSystems](https://docs.aws.amazon.com/efs/latest/ug/API_DescribeFileSystems.html) response   does not match the `KmsKeyId` parameter for [efs-encrypted-check](https://docs.aws.amazon.com/config/latest/developerguide/efs-encrypted-check.html). | MEDIUM | AWS Security Hub Standard via security-config.yaml | 52 52 incomplete |
| [\[EFS.2\] Amazon EFS volumes should be in backup plans](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-efs-2) | This control checks whether Amazon Elastic File System (Amazon EFS) file systems are added to the backup plans in AWS Backup. The control fails if Amazon EFS file systems are not included in the backup plans. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 53 53 incomplete |
| [\[ElasticBeanstalk.1\] Elastic Beanstalk environments should have enhanced health reporting enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elasticbeanstalk-1) | This control checks whether enhanced health reporting is enabled for your AWS Elastic Beanstalk environments. | LOW | AWS Security Hub Standard via security-config.yaml | 54 54 incomplete |
| [\[ElasticBeanstalk.2\] Elastic Beanstalk managed platform updates should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elasticbeanstalk-2) | This control checks whether managed platform updates are enabled for the Elastic Beanstalk environment. | HIGH | AWS Security Hub Standard via security-config.yaml | 55 55 incomplete |
| [\[ELB.2\] Classic Load Balancers with SSL/HTTPS listeners should use a certificate provided by AWS Certificate Manager](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elb-2) | This control checks whether the Classic Load Balancer uses HTTPS/SSL certificates provided by AWS Certificate Manager (ACM). The control fails if the Classic Load Balancer configured with HTTPS/SSL listener does not use a certificate provided by ACM. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 56 56 incomplete |
| [\[ELB.3\] Classic Load Balancer listeners should be configured with HTTPS or TLS termination](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elb-3) | This control checks whether your Classic Load Balancer listeners are configured with HTTPS or TLS protocol for front-end (client to load balancer) connections. The control is applicable if a Classic Load Balancer has listeners. If your Classic Load Balancer does not have a listener configured, then the control does not report any findings. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 57 57 incomplete |
| [\[ELB.4\] Application load balancer should be configured to drop http headers](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elb-4) | This control evaluates AWS Application Load Balancers to ensure they are configured to drop invalid HTTP headers. The control fails if the value of `routing.http.drop_invalid_header_fields.enabled` is set to `false`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 58 58 incomplete |
| [\[ELB.5\] Application and Classic Load Balancers logging should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elb-5) | This control checks whether the Application Load Balancer and the Classic Load Balancerhave logging enabled. The control fails if `access_logs.s3.enabled` is `false`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 59 59 incomplete |
| [\[ELB.6\] Application Load Balancer deletion protection should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elb-6) | This control checks whether an Application Load Balancer has deletion protection enabled. The control fails if deletion protection is not configured. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 60 60 incomplete |
| [\[ELB.7\] Classic Load Balancers should have connection draining enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elb-7) | This control checks whether Classic Load Balancers have connection draining enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 61 61 incomplete |
| [\[ELB.8\] Classic Load Balancers with SSL listeners should use a predefined security policy that has strong configuration](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elb-8) | This control checks whether your Classic Load Balancer HTTPS/SSL listeners use the predefined policy `ELBSecurityPolicy-TLS-1-2-2017-01`. The control fails if the Classic Load Balancer HTTPS/SSL listeners do not use `ELBSecurityPolicy-TLS-1-2-2017-01`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 62 62 incomplete |
| [\[ELB.9\] Classic Load Balancers should have cross-zone load balancing enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elb-9) | This control checks if cross-zone load balancing is enabled for the Classic Load Balancers (CLBs). This control fails if cross-zone load balancing is not enabled for a CLB. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 63 63 incomplete |
| [\[ELB.10\] Classic Load Balancer should span multiple Availability Zones](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elb-10) | This control checks whether a Classic Load Balancer has been configured to span multiple Availability Zones. The control fails if the Classic Load Balancer does not span multiple Availability Zones. |  |  | 64 64 incomplete |
| [\[ELBv2.1\] Application Load Balancer should be configured to redirect all HTTP requests to HTTPS](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-elbv2-1) | This control checks whether HTTP to HTTPS redirection is configured on all HTTP listeners of Application Load Balancers. The check fails if one or more HTTP listeners of Application Load Balancers do not have HTTP to HTTPS redirection configured. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 65 65 incomplete |
| [\[EMR.1\] Amazon Elastic MapReduce cluster master nodes should not have public IP addresses](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-emr-1) | This control checks whether master nodes on Amazon EMR clusters have public IP addresses.  The control fails if the master node has public IP addresses that are associated with any of its instances. Public IP addresses are designated in the `PublicIp` field of the `NetworkInterfaces` configuration for the instance. This control only checks Amazon EMR clusters that are in a `RUNNING` or `WAITING` state. | HIGH | AWS Security Hub Standard via security-config.yaml | 66 66 incomplete |
| [\[ES.1\] Elasticsearch domains should have encryption at-rest enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-es-1) | This control checks whether Elasticsearch domains have encryption at rest configuration enabled. The check fails if encryption at rest is not enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 67 67 incomplete |
| [\[ES.2\] Elasticsearch domains should be in a VPC](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-es-2) | This control checks whether Elasticsearch domains are in a VPC. It does not evaluate the VPC subnet routing configuration to determine public access. You should ensure that Elasticsearch domains are not attached to public subnets. See [Resource-based policies](https://docs.aws.amazon.com/opensearch-service/latest/developerguide/ac.html#ac-types-resource) in the *Amazon OpenSearch Service Developer Guide*. You should also ensure that your VPC is configured according to the recommended best practices. See [Security best practices for your VPC](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-security-best-practices.html) in the *Amazon VPC User Guide*. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 68 68 incomplete |
| [\[ES.3\] Elasticsearch domains should encrypt data sent between nodes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-es-3) | This control checks whether Elasticsearch domains have node-to-node encryption enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 69 69 incomplete |
| [\[ES.4\] Elasticsearch domain error logging to CloudWatch Logs should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-es-4) | This control checks whether Elasticsearch domains are configured to send error logs to CloudWatch Logs. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 70 70 incomplete |
| [\[ES.5\] Elasticsearch domains should have audit logging enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-es-5) | This control checks whether Elasticsearch domains have audit logging enabled. This control fails if an Elasticsearch domain does not have audit logging enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 71 71 incomplete |
| [\[ES.6\] Elasticsearch domains should have at least three data nodes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-es-6) | This control checks whether Elasticsearch domains are configured with at least three data nodes and `zoneAwarenessEnabled` is `true`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 72 72 incomplete |
| [\[ES.7\] Elasticsearch domains should be configured with at least three dedicated master nodes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-es-7) | This control checks whether Elasticsearch domains are configured with at least three dedicated master nodes. This control fails if the domain does not use dedicated master nodes. This control passes if Elasticsearch domains have five dedicated master nodes. However, using more than three master nodes might be unnecessary to mitigate the availability risk, and will result in additional cost. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 73 73 incomplete |
| [\[ES.8\] Connections to Elasticsearch domains should be encrypted using TLS 1.2](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-es-8) | This control checks whether connections to Elasticsearch domains are required to use TLS 1.2. The check fails if the Elasticsearch domain `TLSSecurityPolicy` is not Policy-Min-TLS-1-2-2019-07. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 74 74 incomplete |
| [\[GuardDuty.1\] GuardDuty should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-guardduty-1) | This control checks whether Amazon GuardDuty is enabled in your GuardDuty account and Region. | HIGH | AWS Security Hub Standard via security-config.yaml | 75 75 incomplete |
| [\[IAM.1\] IAM policies should not allow full \\*" administrative privileges"](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-iam-1) | This control checks whether the default version of IAM policies (also known as customer managed policies) has administrator access that includes a statement with "Effect": "Allow" with "Action": "\\*" over "Resource": "\\*".  The control only checks the customer managed policies that you create. It does not check inline and AWS managed policies. | HIGH | AWS Security Hub Standard via security-config.yaml | 76 76 incomplete |
| [\[IAM.2\] IAM users should not have IAM policies attached](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-iam-2) | This control checks that none of your IAM users have policies attached. Instead, IAM users must inherit permissions from IAM groups or roles. | LOW | AWS Security Hub Standard via security-config.yaml | 77 77 incomplete |
| [\[IAM.3\] IAM users' access keys should be rotated every 90 days or less](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-iam-3) | This control checks whether the active access keys are rotated within 90 days. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 78 78 incomplete |
| [\[IAM.4\] IAM root user access key should not exist](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-iam-4) | This control checks whether the root user access key is present. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 79 79 incomplete |
| [\[IAM.5\] MFA should be enabled for all IAM users that have a console password](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-iam-5) | This control checks whether AWS multi-factor authentication (MFA) is enabled for all IAM users that use a console password. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 80 80 incomplete |
| [\[IAM.6\] Hardware MFA should be enabled for the root user](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-iam-6) | This control checks whether your AWS account is enabled to use a hardware multi-factor authentication (MFA) device to sign in with root user credentials. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 81 81 incomplete |
| [\[IAM.7\] Password policies for IAM users should have strong configurations](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-iam-7) | To access the AWS Management Console, IAM users need passwords. As a best practice, Security Hub highly recommends that instead of creating IAM users, you use federation. Federation allows users to use their existing corporate credentials to log into the AWS Management Console. Use AWS Single Sign-On (AWS SSO) to create or federate the user, and then assume an IAM role into an account. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 82 82 incomplete |
| [\[IAM.8\] Unused IAM user credentials should be removed](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-iam-8) | This control checks whether your IAM users have passwords or active access keys that have not been used for 90 days. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 83 83 incomplete |
| [\[IAM.21\] IAM customer managed policies that you create should not allow wildcard actions for services](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-iam-21) | This control checks whether the IAM identity-based policies that you create have Allow statements that use the \\* wildcard to grant permissions for all actions on any service. The control fails if any policy statement includes `"Effect": "Allow"` with `"Action": "Service:*"`. | LOW |  | 84 84 incomplete |
| [\[KMS.1\] IAM customer managed policies should not allow decryption actions on all KMS keys](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-kms-1) | Checks whether the default version of IAM customer managed policies allow principals to use the AWS KMS decryption actions on all resources. This control uses [Zelkova](http://aws.amazon.com/blogs/security/protect-sensitive-data-in-the-cloud-with-automated-reasoning-zelkova/), an automated reasoning engine, to validate and warn you about policies that may grant broad access to your secrets across AWS accounts.  This control fails, and flags the policy as `FAILED`, if the policy is open enough to allow `kms:Decrypt` or `kms:ReEncryptFrom` actions on any arbitrary KMS key.  The control evaluates both attached and unattached customer managed policies. It does not check inline policies or AWS managed policies. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 85 85 incomplete |
| [\[KMS.2\] IAM principals should not have IAM inline policies that allow decryption actions on all KMS keys](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-kms-2) | Checks whether the inline policies that are embedded in your IAM identities (role, user, or group) allow the AWS KMS decryption and re-encryption actions on all KMS keys. This control uses [Zelkova](http://aws.amazon.com/blogs/security/protect-sensitive-data-in-the-cloud-with-automated-reasoning-zelkova/), an automated reasoning engine, to validate and warn you about policies that may grant broad access to your secrets across AWS accounts.  This control fails if the policy is open enough to allow `kms:Decrypt` or `kms:ReEncryptFrom` actions on any arbitrary KMS key. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 86 86 incomplete |
| [\[KMS.3\] AWS KMS keys should not be deleted unintentionally](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-kms-3) | This control checks whether KMS keys are scheduled for deletion. The control fails if a KMS key is scheduled for deletion. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 87 87 incomplete |
| [\[Lambda.1\] Lambda function policies should prohibit public access](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-lambda-1) | This control checks whether the Lambda function resource-based policy prohibits public access outside of your account.  The control also fails if a Lambda function is invoked from Amazon S3 and the policy does not include a condition for `AWS:SourceAccount`. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 88 88 incomplete |
| [\[Lambda.2\] Lambda functions should use supported runtimes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-lambda-2) | This control checks that the Lambda function settings for runtimes match the expected values set for the supported runtimes for each language. This control checks function settings for the following runtimes: `nodejs14.x`, `nodejs12.x`, `python3.9`, `python3.8`, `python3.7`, `python3.6`, `ruby2.7`, `java11`, `java8`, `java8.al2`, `go1.x`, `dotnetcore3.1`, and `dotnet6`.  The AWS Config rule ignores functions that have a package type of `Image`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 89 89 incomplete |
| [\[Lambda.5\] VPC Lambda functions should operate in more than one Availability Zone](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-lambda-5) | This control checks if Lambda has more than one availability zone associated. The rule fails if only one availability zone is associated with Lambda. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 90 90 incomplete |
| [\[NetworkFirewall.6\] Stateless network firewall rule group should not be empty](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-networkfirewall-6) | This control checks if a Stateless Network Firewall Rule Group contains rules. The rule will fail if there are no rules in a Stateless Network Firewall Rule Group. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 91 91 incomplete |
| [\[Opensearch.1\] OpenSearch domains should have encryption at rest enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-opensearch-1) | This control checks whether OpenSearch domains have encryption-at-rest configuration enabled. The check fails if encryption at rest is not enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 92 92 incomplete |
| [\[Opensearch.2\] OpenSearch domains should be in a VPC](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-opensearch-2) | This control checks whether OpenSearch domains are in a VPC. It does not evaluate the VPC subnet routing configuration to determine public access. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 93 93 incomplete |
| [\[Opensearch.3\] OpenSearch domains should encrypt data sent between nodes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-opensearch-3) | This control checks whether OpenSearch domains have node-to-node encryption enabled. This control fails if node-to-node encryption is disabled on the domain. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 94 94 incomplete |
| [\[Opensearch.4\] OpenSearch domain error logging to CloudWatch Logs should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-opensearch-4) | This control checks whether OpenSearch domains are configured to send error logs to CloudWatch Logs. This control fails if error logging to CloudWatch is not enabled for a domain. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 95 95 incomplete |
| [\[Opensearch.5\] OpenSearch domains should have audit logging enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-opensearch-5) | This rule is `NON_COMPLIANT` if the CloudWatch Logs log group of the OpenSearch domain is not specified in this parameter list.  This control checks whether OpenSearch domains have audit logging enabled. This control fails if an OpenSearch domain does not have audit logging enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 96 96 incomplete |
| [\[Opensearch.6\] OpenSearch domains should have at least three data nodes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-opensearch-6) | This control checks whether OpenSearch domains are configured with at least three data nodes and `zoneAwarenessEnabled` is `true`. This control fails for an OpenSearch domain if `instanceCount` is less than 3 or `zoneAwarenessEnabled` is `false`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 97 97 incomplete |
| [\[Opensearch.8\] Connections to OpenSearch domains should be encrypted using TLS 1.2](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-opensearch-8) | This control checks whether connections to OpenSearch domains are required to use TLS 1.2. The check fails if the OpenSearch domain `TLSSecurityPolicy` is not `Policy-Min-TLS-1-2-2019-07`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 98 98 incomplete |
| [\[RDS.1\] RDS snapshot should be private](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-1) | This control checks whether Amazon RDS snapshots are public.  This control is intended for RDS instances. It can also return findings for snapshots of Aurora DB instances, Neptune DB instances, and Amazon DocumentDB clusters, even though they are not evaluated for public accessibility. If these findings are not useful, you can suppress them. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 99 99 incomplete |
| [\[RDS.2\] RDS DB Instances should prohibit public access, as determined by the PubliclyAccessible configuration](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-2) | This control checks whether Amazon RDS instances are publicly accessible by evaluating the `PubliclyAccessible` field in the instance configuration item.  Neptune DB instances and Amazon DocumentDB clusters do not have the `PubliclyAccessible` flag and cannot be evaluated. However, this control can still generate findings for these resources. You can suppress these findings. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 100 100 incomplete |
| [\[RDS.3\] RDS DB instances should have encryption at-rest enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-3) | This control checks whether storage encryption is enabled for your Amazon RDS DB instances.  This control is intended for RDS DB instances. However, it can also generate findings for Aurora DB instances, Neptune DB instances, and Amazon DocumentDB clusters. If these findings are not useful, then you can suppress them. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 101 101 incomplete |
| [\[RDS.4\] RDS cluster snapshots and database snapshots should be encrypted at rest](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-4) | This control checks whether RDS DB snapshots are encrypted.  This control is intended for RDS DB instances. However, it can also generate findings for snapshots of Aurora DB instances, Neptune DB instances, and Amazon DocumentDB clusters. If these findings are not useful, then you can suppress them. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 102 102 incomplete |
| [\[RDS.5\] RDS DB instances should be configured with multiple Availability Zones](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-5) | This control checks whether high availability is enabled for your RDS DB instances. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 103 103 incomplete |
| [\[RDS.6\] Enhanced monitoring should be configured for RDS DB instances](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-6) | This control checks whether enhanced monitoring is enabled for your RDS DB instances. | LOW | AWS Security Hub Standard via security-config.yaml | 104 104 incomplete |
| [\[RDS.7\] RDS clusters should have deletion protection enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-7) | This control checks whether RDS clusters have deletion protection enabled.  This control is intended for RDS DB instances. However, it can also generate findings for Aurora DB instances, Neptune DB instances, and Amazon DocumentDB clusters. If these findings are not useful, then you can suppress them. | LOW | AWS Security Hub Standard via security-config.yaml | 105 105 incomplete |
| [\[RDS.8\] RDS DB instances should have deletion protection enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-8) | This control checks whether your RDS DB instances that use one of the listed database engines have deletion protection enabled. | LOW | AWS Security Hub Standard via security-config.yaml | 106 106 incomplete |
| [\[RDS.9\] Database logging should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-9) | This control checks whether the following logs of Amazon RDS are enabled and sent to CloudWatch Logs:   * Oracle: (Alert, Audit, Trace, Listener) * PostgreSQL: (Postgresql, Upgrade) * MySQL: (Audit, Error, General, SlowQuery) * MariaDB: (Audit, Error, General, SlowQuery) * SQL Server: (Error, Agent) * Aurora: (Audit, Error, General, SlowQuery) * Aurora-MySQL: (Audit, Error, General, SlowQuery) * Aurora-PostgreSQL: (Postgresql, Upgrade). | MEDIUM | AWS Security Hub Standard via security-config.yaml | 107 107 incomplete |
| [\[RDS.10\] IAM authentication should be configured for RDS instances](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-10) | This control checks whether an RDS DB instance has IAM database authentication enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 108 108 incomplete |
| [\[RDS.11\] RDS instances should have automatic backups enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-11) | This control checks whether Amazon Relational Database Service instances have automated backups enabled and the backup retention period is greater than or equal to 7 days. The control fails if backups are not enabled, and if the retention period is less than 7 days. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 109 109 incomplete |
| [\[RDS.12\] IAM authentication should be configured for RDS clusters](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-12) | This control checks whether an Amazon RDS DB cluster has IAM database authentication enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 110 110 incomplete |
| [\[RDS.13\] RDS automatic minor version upgrades should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-13) | This control checks whether automatic minor version upgrades are enabled for the RDS database instance. | HIGH | AWS Security Hub Standard via security-config.yaml | 111 111 incomplete |
| [\[RDS.14\] Amazon Aurora clusters should have backtracking enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-14) | This control checks whether Amazon Aurora clusters have backtracking enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 112 112 incomplete |
| [\[RDS.15\] RDS DB clusters should be configured for multiple Availability Zones](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-15) | This control checks whether high availability is enabled for your RDS DB clusters. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 113 113 incomplete |
| [\[RDS.16\] RDS DB clusters should be configured to copy tags to snapshots](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-16) | This control checks whether RDS DB clusters are configured to copy all tags to snapshots when the snapshots are created. | LOW | AWS Security Hub Standard via security-config.yaml | 114 114 incomplete |
| [\[RDS.17\] RDS DB instances should be configured to copy tags to snapshots](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-17) | This control checks whether RDS DB instances are configured to copy all tags to snapshots when the snapshots are created. | LOW | AWS Security Hub Standard via security-config.yaml | 115 115 incomplete |
| [\[RDS.18\] RDS instances should be deployed in a VPC](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-18) | This control checks whether an RDS instance is deployed in a VPC (EC2-VPC). | HIGH | AWS Security Hub Standard via security-config.yaml | 116 116 incomplete |
| [\[RDS.19\] An RDS event notifications subscription should be configured for critical cluster events](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-19) | This control checks whether an Amazon RDS event subscription exists that has notifications enabled for the following source type, event category key-value pairs. | LOW | AWS Security Hub Standard via security-config.yaml | 117 117 incomplete |
| [\[RDS.20\] An RDS event notifications subscription should be configured for critical database instance events](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-20) | This control checks whether an Amazon RDS event subscription exists with notifications enabled for the following source type, event category key-value pairs. | LOW | AWS Security Hub Standard via security-config.yaml | 118 118 incomplete |
| [\[RDS.21\] An RDS event notifications subscription should be configured for critical database parameter group events](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-21) | This control checks whether an Amazon RDS event subscription exists with notifications enabled for the following source type, event category key-value pairs. | LOW | AWS Security Hub Standard via security-config.yaml | 119 119 incomplete |
| [\[RDS.22\] An RDS event notifications subscription should be configured for critical database security group events](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-22) | This control checks whether an Amazon RDS event subscription exists with notifications enabled for the following source type, event category key-value pairs. | LOW | AWS Security Hub Standard via security-config.yaml | 120 120 incomplete |
| [\[RDS.23\] RDS instances should not use a database engine default port](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-23) | This control checks whether the RDS cluster or instance uses a port other than the default port of the database engine. | LOW | AWS Security Hub Standard via security-config.yaml | 121 121 incomplete |
| [\[RDS.24\] RDS Database Clusters should use a custom administrator username](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-24) | This control checks whether an Amazon RDS database cluster has changed the admin username from its default value. This rule will fail if the admin username is set to the default value. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 122 122 incomplete |
| [\[RDS.25\] RDS Database Instance should use a custom administrator username](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-rds-25) | This control checks whether you've changed the administrative username for Amazon Relational Database Service (Amazon RDS) database instances from the default value. The control fails if the administrative username is set to the default value. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 123 123 incomplete |
| [\[Redshift.1\] Amazon Redshift clusters should prohibit public access](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-redshift-1) | This control checks whether Amazon Redshift clusters are publicly accessible. It evaluates the `PubliclyAccessible` field in the cluster configuration item. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 124 124 incomplete |
| [\[Redshift.2\] Connections to Amazon Redshift clusters should be encrypted in transit](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-redshift-2) | This control checks whether connections to Amazon Redshift clusters are required to use encryption in transit. The check fails if the Amazon Redshift cluster parameter `require_SSL` is not set to 1. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 125 125 incomplete |
| [\[Redshift.3\] Amazon Redshift clusters should have automatic snapshots enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-redshift-3) | This control checks whether Amazon Redshift clusters have automated snapshots enabled. It also checks whether the snapshot retention period is greater than or equal to seven. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 126 126 incomplete |
| [\[Redshift.4\] Amazon Redshift clusters should have audit logging enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-redshift-4) | This control checks whether an Amazon Redshift cluster has audit logging enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 127 127 incomplete |
| [\[Redshift.6\] Amazon Redshift should have automatic upgrades to major versions enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-redshift-6) | This control checks whether automatic major version upgrades are enabled for the Amazon Redshift cluster. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 128 128 incomplete |
| [\[Redshift.7\] Redshift clusters should use enhanced VPC routing](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-redshift-7) | This control checks whether an Amazon Redshift cluster has `EnhancedVpcRouting` enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 129 129 incomplete |
| [\[Redshift.8\] Amazon Redshift clusters should not use the default Admin username](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-redshift-8) | This control checks whether a Amazon Redshift cluster has changed the admin username from its default value. This control will fail if the admin username for a Redshift cluster is set to `awsuser`. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 130 130 incomplete |
| [\[S3.1\] S3 Block Public Access setting should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-1) | This control checks whether the following Amazon S3 public access block settings are configured at the account level:   * `ignorePublicAcls`: `true` * `blockPublicPolicy`: `true` * `blockPublicAcls`: `true` * `restrictPublicBuckets`: `true`   The control passes if all of the public access block settings are set to `true`.  The control fails if any of the settings are set to `false`, or if any of the settings are not configured. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 131 131 incomplete |
| [\[S3.2\] S3 buckets should prohibit public read access](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-2) | This control checks whether your S3 buckets allow public read access. It evaluates the Block Public Access settings, the bucket policy, and the bucket access control list (ACL). | CRITICAL | AWS Security Hub Standard via security-config.yaml | 132 132 incomplete |
| [\[S3.3\] S3 buckets should prohibit public write access](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-3) | This control checks whether your S3 buckets allow public write access. It evaluates the block public access settings, the bucket policy, and the bucket access control list (ACL). | CRITICAL | AWS Security Hub Standard via security-config.yaml | 133 133 incomplete |
| [\[S3.4\] S3 buckets should have server-side encryption enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-4) | This control checks that your S3 bucket either has Amazon S3 default encryption enabled or that the S3 bucket policy explicitly denies put-object requests without server-side encryption. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 134 134 incomplete |
| [\[S3.5\] S3 buckets should require requests to use Secure Socket Layer](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-5) | This control checks whether S3 buckets have policies that require requests to use Secure Socket Layer (SSL). | MEDIUM | AWS Security Hub Standard via security-config.yaml | 135 135 incomplete |
| [\[S3.6\] S3 permissions granted to other AWS accounts in bucket policies should be restricted](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-6) | This control checks whether the S3 bucket policy prevents principals from other AWS accounts from performing denied actions on resources in the S3 bucket. The control fails if the S3 bucket policy allows any of the following actions for a principal in another AWS account:   * `s3:DeleteBucketPolicy` * `s3:PutBucketAcl` * `s3:PutBucketPolicy` * `s3:PutEncryptionConfiguration` * `s3:PutObjectAcl` | HIGH | AWS Security Hub Standard via security-config.yaml | 136 136 incomplete |
| [\[S3.8\] S3 Block Public Access setting should be enabled at the bucket-level](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-8) | This control checks whether S3 buckets have bucket-level public access blocks applied. This control fails is if any of the following settings are set to `false`:   * `ignorePublicAcls` * `blockPublicPolicy` * `blockPublicAcls` * `restrictPublicBuckets` | HIGH | AWS Security Hub Standard via security-config.yaml | 137 137 incomplete |
| [\[S3.9\] S3 bucket server access logging should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-9) | This control checks whether server access logging is enabled for S3 buckets. When logging is enabled, Amazon S3 delivers access logs for a source bucket to a chosen target bucket. The target bucket must be in the same AWS Region as the source bucket and must not have a default retention period configuration. This control passes if server access logging is enabled. The target logging bucket does not need to have server access logging enabled, and you should suppress findings for this bucket. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 138 138 incomplete |
| [\[S3.10\] S3 buckets with versioning enabled should have lifecycle policies configured](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-10) | This control checks if Amazon Simple Storage Service (Amazon S3) version enabled buckets have lifecycle policy configured. This rule fails if Amazon S3 lifecycle policy is not enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 139 139 incomplete |
| [\[S3.11\] S3 buckets should have event notifications enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-11) | This control checks whether S3 Event Notifications are enabled on an Amazon S3 bucket. This control fails if S3 Event Notifications are not enabled on a bucket. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 140 140 incomplete |
| [\[S3.12\] S3 access control lists (ACLs) should not be used to manage user access to buckets](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-12) | This control checks whether Amazon S3 buckets provide user permissions via ACLs. The control fails if ACLs are configured for managing user access on S3 buckets. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 141 141 incomplete |
| [\[SageMaker.1\] Amazon SageMaker notebook instances should not have direct internet access](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-sagemaker-1) | This control checks whether direct internet access is disabled for an SageMaker notebook instance. To do this, it checks whether the `DirectInternetAccess` field is disabled for the notebook instance. | HIGH | AWS Security Hub Standard via security-config.yaml | 142 142 incomplete |
| [\[SecretsManager.1\] Secrets Manager secrets should have automatic rotation enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-secretsmanager-1) | This control checks whether a secret stored in AWS Secrets Manager is configured with automatic rotation. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 143 143 incomplete |
| [\[SecretsManager.2\] Secrets Manager secrets configured with automatic rotation should rotate successfully](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-secretsmanager-2) | This control checks whether an AWS Secrets Manager secret rotated successfully based on the rotation schedule. The control fails if `RotationOccurringAsScheduled` is `false`. The control does not evaluate secrets that do not have rotation configured. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 144 144 incomplete |
| [\[SecretsManager.3\] Remove unused Secrets Manager secrets](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-secretsmanager-3) | This control checks whether your secrets have been accessed within a specified number of days. The default value is 90 days. If a secret was not accessed within the defined number of days, this control fails. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 145 145 incomplete |
| [\[SecretsManager.4\] Secrets Manager secrets should be rotated within a specified number of days](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-secretsmanager-4) | This control checks whether your secrets have been rotated at least once within 90 days. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 146 146 incomplete |
| [\[SNS.1\] SNS topics should be encrypted at-rest using AWS KMS](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-sns-1) | This control checks whether an SNS topic is encrypted at rest using AWS KMS. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 147 147 incomplete |
| [\[SQS.1\] Amazon SQS queues should be encrypted at rest](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-sqs-1) | This control checks whether Amazon SQS queues are encrypted at rest. The control passes if you use an Amazon SQS managed key (SSE-SQS) or an AWS Key Management Service (AWS KMS) key (SSE-KMS). | MEDIUM | AWS Security Hub Standard via security-config.yaml | 148 148 incomplete |
| [\[SSM.1\] EC2 instances should be managed by AWS Systems Manager](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ssm-1) | This control checks whether the stopped and running EC2 instances in your account are managed by AWS Systems Manager. Systems Manager is an AWS service that you can use to view and control your AWS infrastructure. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 149 149 incomplete |
| [\[SSM.2\] EC2 instances managed by Systems Manager should have a patch compliance status of COMPLIANT after a patch installation](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ssm-2) | This control checks whether the compliance status of the Amazon EC2 Systems Manager patch compliance is `COMPLIANT` or `NON_COMPLIANT` after the patch installation on the instance. It only checks instances that are managed by Systems Manager Patch Manager. | HIGH | AWS Security Hub Standard via security-config.yaml | 150 150 incomplete |
| [\[SSM.3\] EC2 instances managed by Systems Manager should have an association compliance status of COMPLIANT](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ssm-3) | This control checks whether the status of the AWS Systems Manager association compliance is `COMPLIANT` or `NON_COMPLIANT` after the association is run on an instance. The control passes if the association compliance status is `COMPLIANT`. | LOW | AWS Security Hub Standard via security-config.yaml | 151 151 incomplete |
| [\[SSM.4\] SSM documents should not be public](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-ssm-4) | This control checks whether AWS Systems Manager documents that are owned by the account are public. This control fails if SSM documents with the owner `Self` are public. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 152 152 incomplete |
| [\[WAF.1\] AWS WAF Classic Global Web ACL logging should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-waf-1) | This control checks whether logging is enabled for an AWS WAF global Web ACL. This control fails if logging is not enabled for the web ACL. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 153 153 incomplete |

#### **PCI DSS v3.2.1**

| Title | Description | Related requirements | Severity | Implementation | Enabled? |
| --- | --- | --- | --- | --- | --- |
| [\[PCI.AutoScaling.1\] Auto scaling groups associated with a load balancer should use load balancer health checks](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-autoscaling-1) | This control checks whether your Auto Scaling groups that are associated with a load balancer are using Elastic Load Balancing health checks. | PCI DSS 2.2 | LOW | AWS Security Hub Standard via security-config.yaml | 154 154 incomplete |
| [\[PCI.CloudTrail.1\] CloudTrail should have encryption at-rest enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-cloudtrail-1) | This control checks whether AWS CloudTrail is configured to use the server-side encryption (SSE) AWS KMS key encryption. | PCI DSS 3.4 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 155 155 incomplete |
| [\[PCI.CloudTrail.2\] CloudTrail should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-cloudtrail-2) | This control checks whether CloudTrail is enabled in your AWS account. | PCI DSS 10.1, PCI DSS 10.2.1, PCI DSS 10.2.2, PCI DSS 10.2.3, PCI DSS 10.2.4, PCI DSS 10.2.5, PCI DSS 10.2.6, PCI DSS 10.2.7, PCI DSS 10.3.1, PCI DSS 10.3.2, PCI DSS 10.3.3, PCI DSS 10.3.4, PCI DSS 10.3.5, PCI DSS 10.3.6 | HIGH | AWS Security Hub Standard via security-config.yaml | 156 156 incomplete |
| [\[PCI.CloudTrail.3\] CloudTrail log file validation should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-cloudtrail-3) | This control checks whether CloudTrail log file validation is enabled.  It does not check when configurations are altered. | PCI DSS 10.5.2, PCI DSS 10.5.5 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 157 157 incomplete |
| [\[PCI.CloudTrail.4\] CloudTrail trails should be integrated with Amazon CloudWatch Logs](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-cloudtrail-4) | This control checks whether CloudTrail trails are configured to send logs to CloudWatch Logs.  It does not check for user permissions to alter logs or log groups. You should create specific CloudWatch rules to alert when CloudTrail logs are altered. | PCI DSS 10.5.3 | LOW | AWS Security Hub Standard via security-config.yaml | 158 158 incomplete |
| [\[PCI.CodeBuild.1\] CodeBuild GitHub or Bitbucket source repository URLs should use OAuth](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-codebuild-1) | This control checks whether the GitHub or Bitbucket source repository URL contains either personal access tokens or a user name and password. | PCI DSS 8.2.1 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 160 160 incomplete |
| [\[PCI.CodeBuild.2\] CodeBuild project environment variables should not contain clear text credentials](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-codebuild-2) | This control checks whether the project contains environment variables `AWS_ACCESS_KEY_ID` and `AWS_SECRET_ACCESS_KEY`. | PCI DSS 8.2.1 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 162 162 incomplete |
| [\[PCI.Config.1\] AWS Config should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-config-1) | This control checks whether AWS Config is enabled in the account for the local Region and is recording all resources.  It does not check for change detection for all critical system files and content files, as AWS Config supports only a subset of resource types. | PCI DSS 10.5.2, PCI DSS 11.5 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 164 164 incomplete |
| [\[PCI.CW.1\] A log metric filter and alarm should exist for usage of the root" user"](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-cw-1) | This control checks for the CloudWatch metric filters using the following pattern:      It checks the following:   * The log group name is configured for use with active multi-Region CloudTrail. * There is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`. * There is at least one active subscriber to an Amazon SNS topic associated with the alarm. | PCI DSS 7.2.1 | LOW | AWS Security Hub Standard via security-config.yaml | 166 166 incomplete |
| [\[PCI.DMS.1\] Database Migration Service replication instances should not be public](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-dms-1) | This control checks whether AWS DMS replication instances are public. To do this, it examines the value of the `PubliclyAccessible` field. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.2, PCI DSS 1.3.4, PCI DSS 1.3.6 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 168 168 incomplete |
| [\[PCI.EC2.1\] EBS snapshots should not be publicly restorable](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-ec2-1) | This control checks whether Amazon Elastic Block Store snapshots are not publicly restorable by everyone. Amazon EBS snapshots should not be publicly restorable by everyone unless you explicitly allow it, to avoid accidental exposure of your companyâ€™s sensitive data. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.4, PCI DSS 7.2.1 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 170 170 incomplete |
| [\[PCI.EC2.2\] The VPC default security group should not allow inbound and outbound traffic](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-ec2-2) | This control checks that the default security group of a VPC does not allow inbound or outbound traffic.  It does not check for access restrictions for other security groups that are not default, and other VPC configurations. | PCI DSS 1.2.1, PCI DSS 1.3.4, PCI DSS 2.1 | HIGH | AWS Security Hub Standard via security-config.yaml | 172 172 incomplete |
| [\[PCI.EC2.4\] Unused EC2 EIPs should be removed](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-ec2-4) | This control checks whether Elastic IP addresses that are allocated to a VPC are attached to Amazon EC2 instances or in-use elastic network interfaces (ENIs).  A failed finding indicates you may have unused Amazon EC2 EIPs. | PCI DSS 2.4 | LOW | AWS Security Hub Standard via security-config.yaml | 174 174 incomplete |
| [\[PCI.EC2.5\] Security groups should not allow ingress from 0.0.0.0/0 to port 22](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-ec2-5) | This control checks whether security groups in use disallow unrestricted incoming SSH traffic.  It does not evaluate outbound traffic. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 2.2.2 | HIGH | AWS Security Hub Standard via security-config.yaml | 176 176 incomplete |
| [\[PCI.EC2.6\] VPC flow logging should be enabled in all VPCs](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-ec2-6) | This control checks whether VPC flow logs are found and enabled for VPCs. The traffic type is set to `REJECT`. | PCI DSS 10.3.3, PCI DSS 10.3.4, PCI DSS 10.3.5, PCI DSS 10.3.6 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 178 178 incomplete |
| [\[PCI.ELBv2.1\] Application Load Balancer should be configured to redirect all HTTP requests to HTTPS](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-elbv2-1) | This control checks whether HTTP to HTTPS redirection is configured on all HTTP listeners of Application Load Balancers. The control fails if any of the HTTP listeners of Application Load Balancers do not have HTTP to HTTPS redirection configured. | PCI DSS 2.3, PCI DSS 4.1 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 180 180 incomplete |
| [\[PCI.ES.1\] Elasticsearch domains should be in a VPC](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-es-1) | This control checks whether Elasticsearch domains are in a VPC.  It does not evaluate the VPC subnet routing configuration to determine public reachability. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.2, PCI DSS 1.3.4, PCI DSS 1.3.6 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 182 182 incomplete |
| [\[PCI.ES.2\] Elasticsearch domains should have encryption at-rest enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-es-2) | This control checks whether Elasticsearch domains have encryption at rest configuration enabled. | PCI DSS 3.4 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 184 184 incomplete |
| [\[PCI.GuardDuty.1\] GuardDuty should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-guardduty-1) | This control checks whether Amazon GuardDuty is enabled in your AWS account and Region. | PCI DSS 11.4 | HIGH | AWS Security Hub Standard via security-config.yaml | 186 186 incomplete |
| [\[PCI.IAM.1\] IAM root user access key should not exist](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-iam-1) | This control checks whether user access keys exist for the root user. | PCI DSS 2.1, PCI DSS 2.2, PCI DSS 7.2.1 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 188 188 incomplete |
| [\[PCI.IAM.2\] IAM users should not have IAM policies attached](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-iam-2) | This control checks that none of your IAM users have policies attached. IAM users must inherit permissions from IAM groups or roles.  It does not check whether least privileged policies are applied to IAM roles and groups. | PCI DSS 7.2.1 | LOW | AWS Security Hub Standard via security-config.yaml | 190 190 incomplete |
| [\[PCI.IAM.3\] IAM policies should not allow full \\*" administrative privileges"](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-iam-3) | This control checks whether the default version of AWS Identity and Access Management policies (also known as customer managed policies) do not have administrator access with a statement that has `"Effect": "Allow" with "Action": "*"` over `"Resource": "*"`.  It only checks for the [customer managed policies](https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#customer-managed-policies) that you created, but does not check for full access to individual services, such as "`S3:*`".  It does not check for [inline and AWS managed policies](https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#aws-managed-policies). | PCI DSS 7.2.1 | HIGH | AWS Security Hub Standard via security-config.yaml | 192 192 incomplete |
| [\[PCI.IAM.4\] Hardware MFA should be enabled for the root user](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-iam-4) | This control checks whether your AWS account is enabled to use multi-factor authentication (MFA) hardware device to sign in with root user credentials.  It does not check whether you are using virtual MFA. | PCI DSS 8.3.1 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 194 194 incomplete |
| [\[PCI.IAM.5\] Virtual MFA should be enabled for the root user](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-iam-5) | This control checks whether users of your AWS account require a multi-factor authentication (MFA) device to sign in with root user credentials.  It does not check whether you are using hardware MFA. | PCI DSS 8.3.1 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 196 196 incomplete |
| [\[PCI.IAM.6\] MFA should be enabled for all IAM users](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-iam-6) | This control checks whether the IAM users have multi-factor authentication (MFA) enabled. | PCI DSS 8.3.1 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 198 198 incomplete |
| [\[PCI.IAM.7\] Unused IAM user credentials should be removed](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-iam-7) | This control checks whether your IAM users have passwords or active access keys that have not been used within a specified number of days. The default is 90 days. | PCI DSS 8.1.4 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 200 200 incomplete |
| [\[PCI.IAM.8\] Password policies for IAM users should have strong configurations](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-iam-8) | This control checks whether the account password policy for IAM users uses the following minimum PCI DSS configurations.   * `RequireUppercaseCharacters` â€“ Require at least one uppercase character in password. (Default = `true`) * `RequireLowercaseCharacters` â€“ Require at least one lowercase character in password. (Default = `true`) * `RequireNumbers` â€“ Require at least one number in password. (Default = `true`) * `MinimumPasswordLength` â€“ Password minimum length. (Default = 7 or longer) * `PasswordReusePrevention` â€“ Number of passwords before allowing reuse. (Default = 4) * MaxPasswordAge â€“ Number of days before password expiration. (Default = 90) | PCI DSS 8.1.4, PCI DSS 8.2.3, PCI DSS 8.2.4, PCI DSS 8.2.5 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 202 202 incomplete |
| [\[PCI.KMS.1\] Customer master key (CMK) rotation should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-kms-1) | This control checks that key rotation is enabled for each KMS key. It does not check KMS keys that have imported key material. | PCI DSS 3.6.4 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 204 204 incomplete |
| [\[PCI.Lambda.1\] Lambda function policies should prohibit public access](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-lambda-1) | This control checks whether the Lambda function resource-based policy prohibits public access.  It does not check for access to the Lambda function by internal principals, such as IAM roles. You should ensure that access to the Lambda function is restricted to authorized principals only by using least privilege Lambda resource-based policies. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.2, PCI DSS 1.3.4, PCI DSS 7.2.1 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 206 206 incomplete |
| [\[PCI.Lambda.2\] Lambda functions should be in a VPC](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-lambda-2) | This control checks whether a Lambda function is in a VPC. You might see failed findings for Lambda@Edge resources.  It does not evaluate the VPC subnet routing configuration to determine public reachability. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.2, PCI DSS 1.3.4 | LOW | AWS Security Hub Standard via security-config.yaml | 208 208 incomplete |
| [\[PCI.Opensearch.1\] OpenSearch domains should be in a VPC](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-opensearch-1) | This control checks whether Amazon OpenSearch domains are in a VPC. It does not evaluate the VPC subnet routing configuration to determine public access. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.2, PCI DSS 1.3.4, PCI DSS 1.3.6 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 210 210 incomplete |
| [\[PCI.Opensearch.2\] OpenSearch domains should have encryption at rest enabled](http://u) | This control checks whether Amazon OpenSearch domains have encryption-at-rest configuration enabled. The check fails if encryption at rest is not enabled. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.4, PCI DSS 7.2.1 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 212 212 incomplete |
| [\[PCI.RDS.1\] RDS snapshot should be private](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-rds-1) | This control checks whether Amazon RDS DB snapshots prohibit access by other accounts. You should also ensure that access to the snapshot and permission to change Amazon RDS configuration is restricted to authorized principals only. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.4, PCI DSS 1.3.6, PCI DSS 7.2.1 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 214 214 incomplete |
| [\[PCI.RDS.2\] RDS DB Instances should prohibit public access, as determined by the PubliclyAccessible configuration](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-rds-2) | This control checks whether RDS instances are publicly accessible by evaluating the `publiclyAccessible` field in the instance configuration item. The value of `publiclyAccessible` indicates whether the DB instance is publicly accessible. When the DB instance is publicly accessible, it is an Internet-facing instance with a publicly resolvable DNS name, which resolves to a public IP address. When the DB instance isn't publicly accessible, it is an internal instance with a DNS name that resolves to a private IP address.  The control does not check VPC subnet routing settings or the Security Group rules. You should also ensure VPC subnet routing does not allow public access, and that the security group inbound rule associated with the RDS instance does not allow unrestricted access (0.0.0.0/0). You should also ensure that access to your RDS instance configuration is limited to only authorized users by restricting users' IAM permissions to modify RDS instances settings and resources. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.2, PCI DSS 1.3.4, PCI DSS 1.3.6, PCI DSS 7.2.1 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 216 216 incomplete |
| [\[PCI.Redshift.1\] Amazon Redshift clusters should prohibit public access](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-redshift-1) | This control checks whether Amazon Redshift clusters are publicly accessible by evaluating the `publiclyAccessible` field in the cluster configuration item. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.2, PCI DSS 1.3.4, PCI DSS 1.3.6 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 218 218 incomplete |
| [\[PCI.S3.1\] S3 buckets should prohibit public write access](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-s3-1) | This control checks whether your S3 buckets allow public write access by evaluating the Block Public Access settings, the bucket policy, and the bucket access control list (ACL).  It does not check for write access to the bucket by internal principals, such as IAM roles. You should ensure that access to the bucket is restricted to authorized principals only. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.2, PCI DSS 1.3.4, PCI DSS 1.3.6, PCI DSS 7.2.1 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 220 220 incomplete |
| [\[PCI.S3.2\] S3 buckets should prohibit public read access](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-s3-2) | This control checks whether your S3 buckets allow public read access by evaluating the Block Public Access settings, the bucket policy, and the bucket access control list (ACL). | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.2, PCI DSS 1.3.6, PCI DSS 7.2.1 | CRITICAL | AWS Security Hub Standard via security-config.yaml | 222 222 incomplete |
| [\[PCI.S3.3\] S3 buckets should have cross-region replication enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-s3-3) | This control checks whether S3 buckets have cross-region replication enabled. | PCI DSS 2.2 | LOW | AWS Security Hub Standard via security-config.yaml | 224 224 incomplete |
| [\[PCI.S3.4\] S3 buckets should have server-side encryption enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-s3-4) | This control checks that your Amazon S3 bucket either has Amazon S3 default encryption enabled or that the S3 bucket policy explicitly denies put-object requests without server-side encryption. | PCI DSS 3.4 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 226 226 incomplete |
| [\[PCI.S3.5\] S3 buckets should require requests to use Secure Socket Layer](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-s3-5) | This control checks whether Amazon S3 buckets have policies that require requests to use Secure Socket Layer (SSL). | PCI DSS 4.1 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 228 228 incomplete |
| [\[PCI.S3.6\] S3 Block Public Access setting should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-s3-6) | This control checks whether the following public access block settings are configured at the account level.   * `ignorePublicAcls`: `true`, * `blockPublicPolicy`: `true` * `blockPublicAcls`: `true` * `restrictPublicBuckets`: `true`   The control passes if all of the public access block settings are set to `true`.  The control fails if any of the settings are set to `false`, or if any of the settings are not configured. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.2, PCI DSS 1.3.4, PCI DSS 1.3.6 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 230 230 incomplete |
| [\[PCI.SageMaker.1\] Amazon SageMaker notebook instances should not have direct internet access](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-sagemaker-1) | This control checks whether direct internet access is disabled for an SageMaker notebook instance. To do this, it checks whether the `DirectInternetAccess` field is disabled for the notebook instance. | PCI DSS 1.2.1, PCI DSS 1.3.1, PCI DSS 1.3.2, PCI DSS 1.3.4, PCI DSS 1.3.6 | HIGH | AWS Security Hub Standard via security-config.yaml | 232 232 incomplete |
| [\[PCI.SSM.1\] EC2 instances managed by Systems Manager should have a patch compliance status of COMPLIANT after a patch installation](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-ssm-1) | This control checks whether the compliance status of the Amazon EC2 Systems Manager patch compliance is `COMPLIANT` or `NON_COMPLIANT` after the patch installation on the instance.  It only checks instances that are managed by AWS Systems Manager Patch Manager.  It does not check whether the patch was applied within the 30-day limit prescribed by PCI DSS requirement 6.2.  It also does not validate whether the patches applied were classified as security patches. | PCI DSS 6.2 | HIGH | AWS Security Hub Standard via security-config.yaml | 234 234 incomplete |
| [\[PCI.SSM.2\] EC2 instances managed by Systems Manager should have an association compliance status of COMPLIANT](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-ssm-2) | This control checks whether the status of the AWS Systems Manager association compliance is `COMPLIANT` or `NON_COMPLIANT` after the association is run on an instance. The control passes if the association compliance status is `COMPLIANT`. | PCI DSS 2.4 | LOW | AWS Security Hub Standard via security-config.yaml | 236 236 incomplete |
| [\[PCI.SSM.3\] EC2 instances should be managed by AWS Systems Manager](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-pci-controls.html#pcidss-ssm-3) | This control checks whether the EC2 instances in your account are managed by Systems Manager. | PCI DSS 2.4 | MEDIUM | AWS Security Hub Standard via security-config.yaml | 238 238 incomplete |
|  |  |  |  |  |  |

#### **CIS AWS Foundations Benchmark v1.2.0**

| Title | Description | Severity | Implementation | Enabled? |
| --- | --- | --- | --- | --- |
| [\[CIS.1.1\] Avoid the use of the root user](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-standards-cis-controls-1.1) | When Security Hub performs the check for this control, it looks for CloudTrail trails that the current account uses. These trails might be organization trails that belong to another account. Multi-Region trails also might be based in a different Region.  The check results in `FAILED` findings in the following cases:   * No trail is configured. * The available trails that are in the current Region and that are owned   by current account do not meet the control requirements.   The check results in a control status of `NO_DATA` in the following cases:   * The multi-Region trail is based in a different Region. Security Hub can   only generate findings in the Region where the trail is based. * The multi-Region trail belongs to a different account. Security Hub can   only generate findings for the account that owns the trail.   For the alarm, the current account must either own the referenced Amazon SNS topic, or must get access to the Amazon SNS topic by calling `ListSubscriptionsByTopic`. Otherwise Security Hub generates `WARNING` findings for the control. | LOW | AWS Security Hub Standard via security-config.yaml | 240 240 incomplete |
| [\[CIS.1.2\] MFA should be enabled for all IAM users that have a console password](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.2) | The AWS Config rule used for this check may take up to 4 hours to accurately report results for MFA. Any findings that are generated within the first 4 hours after you enable the CIS security checks might not be accurate. It may also take up to 4 hours after you remediate this issue for the check to pass. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 242 242 incomplete |
| [\[CIS.1.3\] Unused IAM user credentials should be removed](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.3) | The AWS Config rule for this control uses the [GetCredentialReport](https://docs.aws.amazon.com/IAM/latest/APIReference/API_GetCredentialReport.html) and [GenerateCredentialReport](https://docs.aws.amazon.com/IAM/latest/APIReference/API_GenerateCredentialReport.html)API operations, which are only updated every four hours. Changes to IAM users can take up to four hours to be visible to this control. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 244 244 incomplete |
| [\[CIS.1.4\] IAM users' access keys should be rotated every 90 days or less](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.4) | Checks if the active access keys are rotated within the number of days specified in `maxAccessKeyAge`. The rule is NON\\_COMPLIANT if the access keys have not been rotated for more than `maxAccessKeyAge` number of days. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 246 246 incomplete |
| [\[CIS.1.5\] Ensure IAM password policy requires at least one uppercase letter](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.5) | Checks if the account password policy for IAM users meets the specified requirements indicated in the parameters. This rule is NON\\_COMPLIANT if the account password policy does not meet the specified requirements. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 248 248 incomplete |
| [\[CIS.1.6\] Ensure IAM password policy requires at least one lowercase letter](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.6) | Checks if the account password policy for IAM users meets the specified requirements indicated in the parameters. This rule is NON\\_COMPLIANT if the account password policy does not meet the specified requirements. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 250 250 incomplete |
| [\[CIS.1.7\] Ensure IAM password policy requires at least one symbol](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.7) | Checks if the account password policy for IAM users meets the specified requirements indicated in the parameters. This rule is NON\\_COMPLIANT if the account password policy does not meet the specified requirements. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 252 252 incomplete |
| [\[CIS.1.8\] Ensure IAM password policy requires at least one number](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.8) | Checks if the account password policy for IAM users meets the specified requirements indicated in the parameters. This rule is NON\\_COMPLIANT if the account password policy does not meet the specified requirements. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 254 254 incomplete |
| [\[CIS.1.9\] Ensure IAM password policy requires minimum password length of 14 or greater](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.9) | Checks if the account password policy for IAM users meets the specified requirements indicated in the parameters. This rule is NON\\_COMPLIANT if the account password policy does not meet the specified requirements. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 256 256 incomplete |
| [\[CIS.1.10\] Ensure IAM password policy prevents password reuse](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.10) | Checks if the account password policy for IAM users meets the specified requirements indicated in the parameters. This rule is NON\\_COMPLIANT if the account password policy does not meet the specified requirements. | LOW | AWS Security Hub Standard via security-config.yaml | 258 258 incomplete |
| [\[CIS.1.11\] Ensure IAM password policy expires passwords within 90 days or less](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.11) | Checks if the account password policy for IAM users meets the specified requirements indicated in the parameters. This rule is NON\\_COMPLIANT if the account password policy does not meet the specified requirements. | LOW | AWS Security Hub Standard via security-config.yaml | 260 260 incomplete |
| [\[CIS.1.12\] IAM root user access key should not exist](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.12) | Checks if the root user access key is available. The rule is COMPLIANT if the user access key does not exist. Otherwise, NON\\_COMPLIANT. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 262 262 incomplete |
| [\[CIS.1.13\] Virtual MFA should be enabled for the root user](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.13) | Checks whether the root user of your AWS account requires multi-factor authentication for console sign-in. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 264 264 incomplete |
| [\[CIS.1.14\] Hardware MFA should be enabled for the root user](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.14) | Checks whether the root user of your AWS account requires multi-factor authentication for console sign-in. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 266 266 incomplete |
| [\[CIS.1.16\] IAM users should not have IAM policies attached](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.16) | Checks that none of your IAM users have policies attached. IAM users must inherit permissions from IAM groups or roles. The rule is NONCOMPLIANT if there is at least one IAM user with policies attached. | LOW | AWS Security Hub Standard via security-config.yaml | 268 268 incomplete |
| [\[CIS.1.20\] Ensure a support role has been created to manage incidents with AWS Support](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.20) | Checks whether the IAM policy ARN is attached to an IAM user, or a group with one or more IAM users, or an IAM role with one or more trusted entity. | LOW | AWS Security Hub Standard via security-config.yaml | 270 270 incomplete |
| [\[CIS.1.22\] IAM policies should not allow full \\*" administrative privileges"](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.22) | Checks the IAM policies that you create for Allow statements that grant permissions to all actions on all resources. The rule is NON\\_COMPLIANT if any policy statement includes "Effect": "Allow" with "Action": "\\*" over "Resource": "\\*". | HIGH | AWS Security Hub Standard via security-config.yaml | 272 272 incomplete |
| [\[CIS.2.1\] CloudTrail should be enabled and configured with at least one multi-region trail](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.1) | This control checks that there is at least one multi-Region CloudTrail trail. It also checks that the `ExcludeManagementEventSources` parameter is empty for at least one of those trails. | HIGH | AWS Security Hub Standard via security-config.yaml | 274 274 incomplete |
| [\[CIS.2.2\] CloudTrail log file validation should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.2) | Checks whether AWS CloudTrail creates a signed digest file with logs. AWS recommends that the file validation must be enabled on all trails. The rule is noncompliant if the validation is not enabled. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 276 276 incomplete |
| [\[CIS.2.3\] Ensure the S3 bucket used to store CloudTrail logs is not publicly accessible](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.3) | To run this check, Security Hub first uses custom logic to look for the S3 bucket where your CloudTrail logs are stored. It then uses the AWS Config managed rules to check that bucket is publicly accessible. | CRITICAL | AWS Security Hub Standard via security-config.yaml | 278 278 incomplete |
| [\[CIS.2.4\] CloudTrail trails should be integrated with Amazon CloudWatch Logs](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.4) | Checks whether AWS CloudTrail trails are configured to send logs to Amazon CloudWatch logs. The trail is non-compliant if the CloudWatchLogsLogGroupArn property of the trail is empty. | LOW | AWS Security Hub Standard via security-config.yaml | 280 280 incomplete |
| [\[CIS.2.5\] AWS Config should be enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.5) | To run this check, Security Hub performs custom logic to perform the audit steps prescribed for it in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf). Security Hub also requires that global resources are recorded in each Region, because Security Hub is a regional service and performs its security checks on a Region-by-Region basis. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 282 282 incomplete |
| [\[CIS.2.6\] Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.6) | To run this check, Security Hub first uses custom logic to look for the bucket where your CloudTrail logs are stored and then uses the AWS Config managed rule to check if logging is enabled. | LOW | AWS Security Hub Standard via security-config.yaml | 284 284 incomplete |
| [\[CIS.2.7\] CloudTrail should have encryption at-rest enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.7) | Checks if AWS CloudTrail is configured to use the server side encryption (SSE)AWS Key Management Service (AWS KMS) encryption. The rule is COMPLIANT if the KmsKeyId is defined. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 286 286 incomplete |
| [\[CIS.2.8\] Ensure rotation for customer-created KMS keys is enabled](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.8) | Checks if AWS Key Management Service (AWS KMS) key rotation is enabled for each key and matches to the key ID of the customer created AWS KMS key. The rule is COMPLIANT, if key rotation is enabled for a specific key object. The rule is not applicable to KMS keys that have imported key material. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 288 288 incomplete |
| [\[CIS.2.9\] VPC flow logging should be enabled in all VPCs](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.9) | Checks whether Amazon Virtual Private Cloud flow logs are found and enabled for Amazon VPC. | MEDIUM | AWS Security Hub Standard via security-config.yaml | 290 290 incomplete |
| [\[CIS.3.1\] Ensure a log metric filter and alarm exist for unauthorized API calls](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.1) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms.  CIS recommends that you create a metric filter and alarm unauthorized API calls. Monitoring unauthorized API calls helps reveal application errors and might reduce time to detect malicious activity.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.1 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 292 292 incomplete |
| [\[CIS.3.2\] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.2) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms.  CIS recommends that you create a metric filter and alarm console logins that aren't protected by MFA. Monitoring for single-factor console logins increases visibility into accounts that aren't protected by MFA.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.2 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 294 294 incomplete |
| [\[CIS.3.3\] A log metric filter and alarm should exist for usage of the root" user"](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.3) | You can do real-time monitoring of API calls directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms.  CIS recommends that you create a metric filter and alarm for root user login attempts. Monitoring for root user logins provides visibility into the use of a fully privileged account and an opportunity to reduce the use of it.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.3 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 296 296 incomplete |
| [\[CIS.3.4\] Ensure a log metric filter and alarm exist for IAM policy changes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.4) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms.  CIS recommends that you create a metric filter and alarm for changes made to IAM policies. Monitoring these changes helps ensure that authentication and authorization controls remain intact.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.4 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 298 298 incomplete |
| [\[CIS.3.5\] Ensure a log metric filter and alarm exist for CloudTrail configuration changes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.5) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms.  CIS recommends that you create a metric filter and alarm for changes to CloudTrail configuration settings. Monitoring these changes helps ensure sustained visibility to activities in the account.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.5 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 300 300 incomplete |
| [\[CIS.3.6\] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.6) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms.  CIS recommends that you create a metric filter and alarm for failed console authentication attempts. Monitoring failed console logins might decrease lead time to detect an attempt to brute-force a credential, which might provide an indicator, such as source IP, that you can use in other event correlations.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.6 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 302 302 incomplete |
| [\[CIS.3.7\] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.7) | To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.7 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf). This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. The control also fails if `ExcludeManagementEventSources` contains [kms.amazonaws.com](http://kms.amazonaws.com). | LOW | AWS Security Hub Standard via security-config.yaml | 304 304 incomplete |
| [\[CIS.3.8\] Ensure a log metric filter and alarm exist for S3 bucket policy changes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.8) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms.  CIS recommends that you create a metric filter and alarm for changes to S3 bucket policies. Monitoring these changes might reduce time to detect and correct permissive policies on sensitive S3 buckets.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.8 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 306 306 incomplete |
| [\[CIS.3.9\] Ensure a log metric filter and alarm exist for AWS Config configuration changes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.9) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms.  CIS recommends that you create a metric filter and alarm for changes to AWS Config configuration settings. Monitoring these changes helps ensure sustained visibility of configuration items in the account.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.9 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 308 308 incomplete |
| [\[CIS.3.10\] Ensure a log metric filter and alarm exist for security group changes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.10) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Security groups are a stateful packet filter that controls ingress and egress traffic in a VPC.  CIS recommends that you create a metric filter and alarm for changes to security groups. Monitoring these changes helps ensure that resources and services aren't unintentionally exposed.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.10 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 310 310 incomplete |
| [\[CIS.3.11\] Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.11) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets in a VPC.  CIS recommends that you create a metric filter and alarm for changes to NACLs. Monitoring these changes helps ensure that AWS resources and services aren't unintentionally exposed.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.11 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 312 312 incomplete |
| [\[CIS.3.12\] Ensure a log metric filter and alarm exist for changes to network gateways](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.12) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send and receive traffic to a destination outside a VPC.  CIS recommends that you create a metric filter and alarm for changes to network gateways. Monitoring these changes helps ensure that all ingress and egress traffic traverses the VPC border via a controlled path.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.12 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 314 314 incomplete |
| [\[CIS.3.13\] Ensure a log metric filter and alarm exist for route table changes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.13) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables route network traffic between subnets and to network gateways.  CIS recommends that you create a metric filter and alarm for changes to route tables. Monitoring these changes helps ensure that all VPC traffic flows through an expected path.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.13 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 316 316 incomplete |
| [\[CIS.3.14\] Ensure a log metric filter and alarm exist for VPC changes](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-3.14) | You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. You can have more than one VPC in an account, and you can create a peer connection between two VPCs, enabling network traffic to route between VPCs.  CIS recommends that you create a metric filter and alarm for changes to VPCs. Monitoring these changes helps ensure that authentication and authorization controls remain intact.  To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.14 in the [CIS AWS Foundations Benchmark v1.2](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)  This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. | LOW | AWS Security Hub Standard via security-config.yaml | 318 318 incomplete |
| [\[CIS.4.1\] Security groups should not allow ingress from 0.0.0.0/0 to port 22](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-4.1) | Checks if the incoming SSH traffic for the security groups is accessible. The rule is COMPLIANT when IP addresses of the incoming SSH traffic in the security groups are restricted (CIDR other than 0.0.0.0/0). This rule applies only to IPv4. | HIGH | AWS Security Hub Standard via security-config.yaml | 320 320 incomplete |
| [\[CIS.4.2\] Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-4.2) | Checks if the security groups in use do not allow unrestricted incoming TCP traffic to the specified ports. The rule is COMPLIANT when the IP addresses for inbound TCP connections are restricted to the specified ports. This rule applies only to IPv4. | HIGH | AWS Security Hub Standard via security-config.yaml | 322 322 incomplete |
| [\[CIS.4.3\] The VPC default security group should not allow inbound and outbound traffic](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-4.3) | Checks that the default security group of any Amazon Virtual Private Cloud (VPC) does not allow inbound or outbound traffic. The rule returns NOT\\_APPLICABLE if the security group is not default. The rule is NON\\_COMPLIANT if the default security group has one or more inbound or outbound traffic rules. | HIGH | AWS Security Hub Standard via security-config.yaml | 324 324 incomplete |