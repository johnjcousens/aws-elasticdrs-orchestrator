# AMI-Management-Design

**Confluence Page:** https://healthedge.atlassian.net/wiki/spaces/CP1/pages/4866999003/AMI-Management-Design

**Created by:** Chris Falk on June 16, 2025  
**Last modified by:** Lei Shi on September 25, 2025 at 11:07 PM

---

| **Overview** |
| --- |
| AMI management includes the AMI creation, AMI testing, AMI encryption, AMI distribution across AWS regions, and AMI sharing with AWS accounts.  The steps required for these activities can be manually performed using the AWS console or they can be automated using AWS EC2 Image Builder or by building a custom automated solution that may include open source tools such as Packer as well as AWS tools such as the AWS CLI, AWS SDK, and AWS APIs.  An automated approach will commonly use scripts or custom programs created to automate the various AMI management tasks.  These scripts and programs can be implemented as an automated process using an orchestration service or tool such as AWS CodePipeline. |

| **AWS Recommended Cloud Approach** |
| --- |
| The AWS recommended approach uses Amazon EC2 Image Builder for AMI management.  EC2 Image builder automates the AMI creation, AMI testing, AMI encryption, AMI distribution across AWS regions, and AMI sharing with AWS accounts.  It is recommended that customers follow an Infrastructure as Code (IaC) approach and configure / create EC2 Image Builder pipelines using CloudFormation.  A separate EC2 Image Pipeline should be created for every supported operating system and major version.  For example, there would be two separate EC2 Image Builder pipelines for operating systems Windows Server 2019 and Redhat Enterprise Linux V8.  A separate AWS CMK KMS key for EBS volume / snapshot encryption should be created in the same account and region where the EC2 Image Builder pipeline is created.  Alternatively, the KMS key can can be created in a separate security account and the KMS key can then be shared with the EC2 Image Builder account. |

| **Design Decisions** |
| --- |
| The following design decisions need to be made in order to complete the AMI Management Design. HE_Golden_Image_Architecture.png  Home Account The AWS account where AMIs will be produced is CloudOps (360783618952)  This account is a member of the HealthEdge AWS organizations, under Infrastructure OU. The account is where shared services or shared resources for the whole organization reside. Home Region us-east-1 Target Accounts The Golden Image pipeline produced AMI images will be shared to entire HealthEdge organization. Future net-new built EC2 instances in all accounts should be built out of these Golden Images. Target Regions  * us-east-1 * us-east-2 * us-west-1 * us-west-2  Operating Systems (OS) and Versions  * Amazon Linux 2023 * Redhat Enterprise Linux 8 * Redhat Enterprise Linux 10 * Debian 12 * Windows Server 2019 DC * Windows Server 2022 DC * Windows Server 2025 DC    Seed AMIs Below are as of September 25, 2025, future seed AMI will be replaced with latest versions:   * Amazon Linux 2023 kernel-6.12 AMI (ami-0886832e6b5c3b9e2) * [Red Hat Enterprise Linux 8](https://console.aws.amazon.com/marketplace/search/listing/prodview-kv5mi3ksb2mma?sr=0-1&ref_=beagle&applicationId=AWS-EC2-Console) * [Red Hat Enterprise Linux for AWS (RHEL 10)](https://console.aws.amazon.com/marketplace/search/listing/prodview-dejj3fgvzazlg?sr=0-3&ref_=beagle&applicationId=AWS-EC2-Console) * [Debian 12](https://console.aws.amazon.com/marketplace/search/listing/prodview-g5rooj5oqzrw4?sr=0-2&ref_=beagle&applicationId=AWS-EC2-Console) * [Microsoft Windows Server 2019 Base](https://console.aws.amazon.com/marketplace/search/listing/prodview-bd6o47htpbnoe?sr=0-10&ref_=beagle&applicationId=AWS-EC2-Console) * [Microsoft Windows Server 2022 Base](https://console.aws.amazon.com/marketplace/search/listing/prodview-dq4sxno5vuy7m?sr=0-12&ref_=beagle&applicationId=AWS-EC2-Console) * [Microsoft Windows Server 2025 Base](https://console.aws.amazon.com/marketplace/search/listing/prodview-g76csvka4r3by?sr=0-3&ref_=beagle&applicationId=AWS-EC2-Console)  Volume Configuration  * 8GB for Linux * 30GB for Windows  Volume Encryption Default KMS key for EBS, provisioned via LZA, which is using same alias cross accounts and cross regions.  alias: accelerator/ebs/default-encryption/key AMI Naming Convention <OS>-<OS Version> <yyyy-mm-dd>T<hh-mm-ss>.xxxxxxx  Examples:   * al-2023 2025-09-25T14-25-12.516172Z * rhel-8 2025-09-04T03-08-12.032717Z * win-2022 2025-09-03T18-52-50.143969Z  Standard Agents / Services / Software  * salt-minion * crowdstrike-falcon sensor * amazon-ssm-agent * aws-cli-version-2-linux * amazon-corretto-17-jdk  Standard Configuration The Golden Image is a baseline images for all HealthEdge BU to use as starting point of an EC2 instance. The Golden Image only includes the basic public OS and 5 standard agents/software listed in above section.  Each EC2 instance after provisioned out of the Golden Images should be connected and managed by Salt master for customizations and configurations before put in use in any environment except for Sandbox accounts. Network connectivity to external services / repositories Golden Image build pipeline need internet access, which is provided by landing zone after traffic inspection. (See Landing Zone design for details)  An S3 bucket is also used to hosting crowd strike-falcon sensor software, and future additional HealthEdge required baselining software. |